<!DOCTYPE html>
<html data-theme="dark" lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Álgebra Lineal - Unidad I: Matrices y Determinantes</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap');

:root{ 
  --base-font:16px; 
  --bg:#1a1f2e;
  --panel:#2a3142ee;
  --ink:#ffffff;
  --muted:#94a3b8;
  --primary:#6496fa;
  --secondary:#00d4aa;
  --accent:#ffd60a;
  --success:#06d6a0;
  --warn:#ffbe0b;
  --danger:#ef476f;
  --steel:#64748b;
  --grad-primary: linear-gradient(135deg, #6496fa 0%, #00d4aa 100%);
}

[data-theme="light"] {
  --bg:#f8fafc;
  --panel:#ffffff;
  --ink:#1e293b;
  --muted:#64748b;
  --primary:#3b82f6;
  --secondary:#10b981;
  --accent:#f59e0b;
  --success:#059669;
  --warn:#d97706;
  --danger:#dc2626;
  --steel:#94a3b8;
}

*{box-sizing:border-box;margin:0;padding:0;}
html,body{min-height:100vh;font-size:var(--base-font);line-height:1.65;}

body{
  font-family:'Inter',sans-serif;
  color:var(--ink);
  background:var(--bg);
  min-height:100vh;
  padding:0;
  overflow:hidden;
  transition: all 0.3s ease;
}

/* Controles de navegación */
.nav-controls {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 15px;
  z-index: 1000;
  background: rgba(42, 49, 66, 0.9);
  padding: 15px 25px;
  border-radius: 50px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(100, 150, 250, 0.3);
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

[data-theme="light"] .nav-controls {
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.nav-btn {
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 12px;
  padding: 12px 20px;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 120px;
  justify-content: center;
}

.nav-btn:hover {
  background: var(--secondary);
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.nav-btn:disabled {
  background: var(--steel);
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.utility-controls {
  position: fixed;
  top: 20px;
  right: 20px;
  display: flex;
  gap: 10px;
  z-index: 1000;
}

.util-btn {
  background: rgba(42, 49, 66, 0.9);
  color: white;
  border: 1px solid rgba(100, 150, 250, 0.3);
  border-radius: 8px;
  padding: 8px 12px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

[data-theme="light"] .util-btn {
  background: rgba(255, 255, 255, 0.9);
  color: var(--ink);
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.util-btn:hover {
  background: var(--primary);
}

/* Slides */
.slides-container {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  position: relative;
}

.slide {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  padding: 60px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  opacity: 0;
  transform: translateX(100%);
  transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  overflow-y: auto;
}

.slide.active {
  opacity: 1;
  transform: translateX(0);
}

.slide.previous {
  transform: translateX(-100%);
}

/* PORTADA MEJORADA */
.cover-slide {
  text-align: center;
  background: 
    radial-gradient(circle at 20% 80%, rgba(100, 150, 250, 0.15) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(0, 212, 170, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 40% 40%, rgba(255, 214, 10, 0.05) 0%, transparent 50%),
    linear-gradient(135deg, var(--bg) 0%, color-mix(in srgb, var(--bg) 70%, var(--primary) 30%) 100%);
  position: relative;
  overflow: hidden;
}

[data-theme="light"] .cover-slide {
  background: 
    radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.08) 0%, transparent 50%),
    radial-gradient(circle at 40% 40%, rgba(245, 158, 11, 0.05) 0%, transparent 50%),
    linear-gradient(135deg, var(--bg) 0%, color-mix(in srgb, var(--bg) 90%, var(--primary) 10%) 100%);
}

/* Grid de fondo animado */
.matrix-grid-bg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: 
    linear-gradient(rgba(100, 150, 250, 0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(100, 150, 250, 0.1) 1px, transparent 1px);
  background-size: 50px 50px;
  animation: gridMove 20s linear infinite;
  opacity: 0.3;
}

[data-theme="light"] .matrix-grid-bg {
  background-image: 
    linear-gradient(rgba(59, 130, 246, 0.15) 1px, transparent 1px),
    linear-gradient(90deg, rgba(59, 130, 246, 0.15) 1px, transparent 1px);
}

@keyframes gridMove {
  0% { transform: translate(0, 0); }
  100% { transform: translate(50px, 50px); }
}

/* Partículas flotantes */
.floating-symbols {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.symbol {
  position: absolute;
  font-family: 'JetBrains Mono', monospace;
  font-size: 24px;
  color: rgba(100, 150, 250, 0.6);
  animation: float 6s ease-in-out infinite;
}

[data-theme="light"] .symbol {
  color: rgba(59, 130, 246, 0.5);
}

.symbol:nth-child(1) { top: 20%; left: 10%; animation-delay: 0s; }
.symbol:nth-child(2) { top: 80%; left: 85%; animation-delay: 1s; }
.symbol:nth-child(3) { top: 60%; left: 15%; animation-delay: 2s; }
.symbol:nth-child(4) { top: 30%; left: 90%; animation-delay: 3s; }
.symbol:nth-child(5) { top: 70%; left: 70%; animation-delay: 4s; }
.symbol:nth-child(6) { top: 40%; left: 5%; animation-delay: 5s; }

@keyframes float {
  0%, 100% { transform: translateY(0px) rotate(0deg); }
  50% { transform: translateY(-20px) rotate(180deg); }
}

/* Brackets animados */
.brackets {
  position: absolute;
  font-family: 'JetBrains Mono', monospace;
  font-size: 120px;
  color: rgba(100, 150, 250, 0.3);
  font-weight: 900;
  animation: pulse 4s ease-in-out infinite;
}

[data-theme="light"] .brackets {
  color: rgba(59, 130, 246, 0.2);
}

.left-bracket {
  left: 10%;
  top: 50%;
  transform: translateY(-50%);
}

.right-bracket {
  right: 10%;
  top: 50%;
  transform: translateY(-50%);
}

@keyframes pulse {
  0%, 100% { opacity: 0.3; transform: translateY(-50%) scale(1); }
  50% { opacity: 0.6; transform: translateY(-50%) scale(1.1); }
}

/* Títulos mejorados */
.cover-title {
  font-size: clamp(3rem, 6vw, 5rem);
  font-weight: 900;
  background: linear-gradient(135deg, var(--ink) 0%, var(--primary) 30%, var(--secondary) 70%, var(--accent) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 20px;
  position: relative;
  z-index: 2;
  text-shadow: 0 0 30px rgba(100, 150, 250, 0.3);
  animation: titleGlow 3s ease-in-out infinite alternate;
}

@keyframes titleGlow {
  from { text-shadow: 0 0 30px rgba(100, 150, 250, 0.3); }
  to { text-shadow: 0 0 50px rgba(100, 150, 250, 0.6), 0 0 70px rgba(0, 212, 170, 0.4); }
}

.cover-subtitle {
  font-size: clamp(1.8rem, 4vw, 3rem);
  background: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-weight: 700;
  margin-bottom: 40px;
  position: relative;
  z-index: 2;
}

/* Objetivos de aprendizaje mejorados */
.learning-objectives {
  max-width: 800px;
  margin: 40px auto;
  text-align: center;
  position: relative;
  z-index: 2;
  background: rgba(42, 49, 66, 0.7);
  backdrop-filter: blur(10px);
  border-radius: 20px;
  padding: 30px;
  border: 1px solid rgba(100, 150, 250, 0.3);
  box-shadow: 0 20px 40px rgba(0,0,0,0.2);
  animation: slideUp 1s ease-out;
}

[data-theme="light"] .learning-objectives {
  background: rgba(255, 255, 255, 0.8);
  border: 1px solid rgba(59, 130, 246, 0.3);
}

@keyframes slideUp {
  from { 
    opacity: 0;
    transform: translateY(30px);
  }
  to { 
    opacity: 1;
    transform: translateY(0);
  }
}

.learning-objectives h3 {
  color: var(--accent);
  margin-bottom: 20px;
  font-size: 1.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.learning-objectives p {
  font-size: 1.2rem;
  line-height: 1.8;
  text-align: center;
  background: linear-gradient(135deg, var(--ink) 0%, var(--primary) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Botón CTA mejorado */
.cta-button {
  margin-top: 50px;
  position: relative;
  z-index: 2;
}

.glow-button {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  border: none;
  border-radius: 50px;
  padding: 18px 40px;
  font-size: 1.2rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(100, 150, 250, 0.3);
}

.glow-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s;
}

.glow-button:hover::before {
  left: 100%;
}

.glow-button:hover {
  transform: translateY(-5px) scale(1.05);
  box-shadow: 0 20px 40px rgba(100, 150, 250, 0.5);
}

/* Efectos de partículas */
.particles {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.particle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: var(--primary);
  border-radius: 50%;
  animation: particleFloat 8s linear infinite;
}

@keyframes particleFloat {
  0% {
    transform: translateY(100vh) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    transform: translateY(-100px) rotate(360deg);
    opacity: 0;
  }
}

/* Estilos para el contenido de las semanas */
.week-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 30px;
  max-width: 1000px;
  margin: 40px auto;
}

.week-card {
  background: linear-gradient(145deg, var(--panel), var(--bg));
  border: 2px solid var(--primary);
  border-radius: 20px;
  padding: 30px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  text-decoration: none;
  color: inherit;
  animation: fadeInUp 0.6s ease-out;
}

.week-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.3);
  border-color: var(--secondary);
}

.week-number {
  font-size: 3rem;
  font-weight: 900;
  color: var(--primary);
  margin-bottom: 15px;
}

.week-title {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 15px;
  color: var(--secondary);
}

.week-topics {
  font-size: 0.9rem;
  color: var(--muted);
  line-height: 1.6;
}

/* Contenido de las semanas */
.content-container {
  max-width: 1200px;
  width: 100%;
  background: linear-gradient(145deg, var(--panel), var(--bg));
  border-radius: 20px;
  padding: 40px;
  border: 1px solid rgba(100, 150, 250, 0.3);
  box-shadow: 0 20px 50px rgba(0,0,0,0.3);
  max-height: 80vh;
  overflow-y: auto;
}

[data-theme="light"] .content-container {
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.content-container::-webkit-scrollbar {
  width: 8px;
}

.content-container::-webkit-scrollbar-track {
  background: rgba(26, 31, 46, 0.5);
  border-radius: 4px;
}

.content-container::-webkit-scrollbar-thumb {
  background: var(--primary);
  border-radius: 4px;
}

.section-title {
  font-size: 2rem;
  font-weight: 700;
  color: var(--secondary);
  margin-bottom: 30px;
  text-align: center;
  border-bottom: 2px solid var(--primary);
  padding-bottom: 15px;
  animation: fadeInUp 0.6s ease-out;
}

/* Estilos para el contenido detallado */
.card {
  background: linear-gradient(145deg, var(--panel), var(--bg));
  border: 1px solid rgba(100, 150, 250, 0.3);
  border-radius: 20px;
  padding: 25px;
  margin: 20px 0;
  overflow: visible;
  animation: fadeInUp 0.6s ease-out 0.1s both;
}

[data-theme="light"] .card {
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.card h4 {
  color: var(--primary);
  font-size: 1.2rem;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.two-col {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 25px;
  margin: 20px 0;
}

.three-col {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 20px;
  margin: 20px 0;
}

@media (max-width:900px) {
  .two-col, .three-col { grid-template-columns: 1fr; }
}

.definition-box {
  background: rgba(0,212,170,0.15);
  border-left: 4px solid var(--secondary);
  border-radius: 12px;
  padding: 20px;
  margin: 15px 0;
  font-size: 1rem;
  animation: fadeInUp 0.6s ease-out 0.2s both;
}

.definition-box strong {
  color: var(--ink);
}

.example-box {
  background: rgba(100,150,250,0.1);
  border: 1px solid rgba(100,150,250,0.3);
  border-radius: 12px;
  padding: 20px;
  margin: 15px 0;
  animation: fadeInUp 0.6s ease-out 0.3s both;
}

[data-theme="light"] .example-box {
  background: rgba(59, 130, 246, 0.05);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.property-box {
  background: rgba(255,190,11,0.1);
  border-left: 4px solid var(--warn);
  border-radius: 12px;
  padding: 20px;
  margin: 15px 0;
  animation: fadeInUp 0.6s ease-out 0.4s both;
}

.citation {
  font-size: 0.9rem;
  color: var(--muted);
  font-style: italic;
  margin-top: 10px;
  border-left: 3px solid var(--primary);
  padding-left: 12px;
  animation: fadeInUp 0.6s ease-out 0.5s both;
}

.matrix-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  margin: 20px 0;
  flex-wrap: wrap;
  animation: fadeInUp 0.6s ease-out 0.6s both;
}

.matrix {
  border: 2px solid var(--primary);
  border-radius: 12px;
  padding: 20px;
  background: rgba(26,31,46,0.8);
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  font-family: 'JetBrains Mono', monospace;
  font-size: 1.1rem;
}

[data-theme="light"] .matrix {
  background: rgba(255, 255, 255, 0.9);
}

.matrix-grid {
  display: grid;
  gap: 10px;
}

.matrix-2x2 { grid-template-columns: repeat(2,1fr); }
.matrix-3x3 { grid-template-columns: repeat(3,1fr); }

.matrix-cell {
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(100,150,250,0.1);
  border: 1px solid rgba(100,150,250,0.3);
  border-radius: 8px;
  font-weight: 600;
}

[data-theme="light"] .matrix-cell {
  background: rgba(59, 130, 246, 0.05);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.operation-symbol {
  font-size: 2rem;
  color: var(--secondary);
  font-weight: bold;
  margin: 0 15px;
}

.math-display {
  text-align: center;
  font-size: 1.3rem;
  margin: 25px 0;
  padding: 20px;
  background: rgba(26,31,46,0.6);
  border-radius: 12px;
  border: 1px solid rgba(100,150,250,0.2);
  font-family: 'JetBrains Mono', monospace;
  animation: fadeInUp 0.6s ease-out 0.7s both;
}

[data-theme="light"] .math-display {
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.step-by-step {
  background: rgba(6,214,160,0.1);
  border-radius: 12px;
  padding: 20px;
  margin: 20px 0;
  border-left: 4px solid var(--success);
  animation: fadeInUp 0.6s ease-out 0.8s both;
}

.step {
  margin: 15px 0;
  padding: 12px;
  background: rgba(255,255,255,0.05);
  border-radius: 8px;
  animation: fadeInUp 0.6s ease-out 0.9s both;
}

[data-theme="light"] .step {
  background: rgba(0, 0, 0, 0.02);
}

.step-number {
  display: inline-block;
  background: var(--primary);
  color: white;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  text-align: center;
  line-height: 30px;
  font-weight: bold;
  margin-right: 10px;
}

.week-section {
  margin: 40px 0;
  padding: 20px;
  border-radius: 16px;
  background: rgba(42, 49, 66, 0.5);
  border: 1px solid rgba(100, 150, 250, 0.2);
  animation: fadeInUp 0.6s ease-out;
}

[data-theme="light"] .week-section {
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.week-badge {
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-weight: bold;
  font-size: 1rem;
  display: inline-block;
  margin-bottom: 15px;
}

.application-section {
  background: linear-gradient(145deg, var(--panel), var(--bg));
  border-radius: 20px;
  padding: 30px;
  margin: 40px 0;
  border: 2px solid var(--accent);
  position: relative;
  animation: fadeInUp 0.6s ease-out;
}

.application-section::before {
  content: '🎯';
  position: absolute;
  top: -15px;
  left: 30px;
  background: var(--accent);
  color: var(--bg);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  font-weight: bold;
}

.solution-step {
  background: rgba(255, 214, 10, 0.1);
  border-left: 4px solid var(--accent);
  border-radius: 12px;
  padding: 20px;
  margin: 15px 0;
}

.analysis-box {
  background: rgba(239, 71, 111, 0.1);
  border-left: 4px solid var(--danger);
  border-radius: 12px;
  padding: 20px;
  margin: 15px 0;
}

.conclusion-box {
  background: rgba(6, 214, 160, 0.1);
  border-left: 4px solid var(--success);
  border-radius: 12px;
  padding: 20px;
  margin: 15px 0;
}

.bibliography-section {
  background: linear-gradient(145deg, var(--panel), var(--bg));
  border-radius: 20px;
  padding: 30px;
  margin: 40px 0;
  border: 2px solid var(--primary);
  animation: fadeInUp 0.6s ease-out;
}

.bibliography-item {
  background: rgba(100, 150, 250, 0.1);
  border-radius: 12px;
  padding: 15px;
  margin: 10px 0;
  border-left: 4px solid var(--primary);
  animation: fadeInUp 0.6s ease-out;
}

[data-theme="light"] .bibliography-item {
  background: rgba(59, 130, 246, 0.05);
}

.bibliography-category {
  color: var(--secondary);
  font-weight: 600;
  margin: 20px 0 10px 0;
  font-size: 1.1rem;
}

.resource-link {
  color: var(--primary);
  text-decoration: none;
  transition: color 0.2s;
}

.resource-link:hover {
  color: var(--secondary);
  text-decoration: underline;
}

.highlight {
  background: rgba(255, 214, 10, 0.2);
  padding: 2px 6px;
  border-radius: 4px;
  font-weight: 600;
}

/* Indicador de progreso */
.progress-bar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: rgba(42, 49, 66, 0.5);
  z-index: 1001;
}

[data-theme="light"] .progress-bar {
  background: rgba(59, 130, 246, 0.2);
}

.progress {
  height: 100%;
  background: var(--grad-primary);
  width: 0%;
  transition: width 0.3s ease;
}

/* Nuevos componentes para mejoras */
.search-container {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
}

.search-box {
  background: rgba(42, 49, 66, 0.9);
  border: 1px solid rgba(100, 150, 250, 0.3);
  border-radius: 25px;
  padding: 8px 15px;
  color: white;
  width: 200px;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

[data-theme="light"] .search-box {
  background: rgba(255, 255, 255, 0.9);
  color: var(--ink);
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.search-box:focus {
  width: 300px;
  outline: none;
  border-color: var(--primary);
}

.theme-toggle {
  position: fixed;
  top: 20px;
  right: 120px;
  z-index: 1000;
}

.theme-btn {
  background: rgba(42, 49, 66, 0.9);
  color: white;
  border: 1px solid rgba(100, 150, 250, 0.3);
  border-radius: 8px;
  padding: 8px 12px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

[data-theme="light"] .theme-btn {
  background: rgba(255, 255, 255, 0.9);
  color: var(--ink);
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.quiz-container {
  background: linear-gradient(145deg, var(--panel), var(--bg));
  border-radius: 20px;
  padding: 30px;
  margin: 20px 0;
  border: 2px solid var(--primary);
  animation: fadeInUp 0.6s ease-out;
}

.quiz-question {
  margin-bottom: 20px;
  font-weight: 600;
}

.quiz-options {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin: 15px 0;
}

.quiz-option {
  padding: 12px 15px;
  background: rgba(100, 150, 250, 0.1);
  border: 1px solid rgba(100, 150, 250, 0.3);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
}

[data-theme="light"] .quiz-option {
  background: rgba(59, 130, 246, 0.05);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.quiz-option:hover {
  background: rgba(100, 150, 250, 0.2);
  transform: translateX(5px);
}

.quiz-option.correct {
  background: rgba(6, 214, 160, 0.2);
  border-color: var(--success);
}

.quiz-option.incorrect {
  background: rgba(239, 71, 111, 0.2);
  border-color: var(--danger);
}

.calculator-container {
  background: linear-gradient(145deg, var(--panel), var(--bg));
  border-radius: 20px;
  padding: 25px;
  margin: 20px 0;
  border: 2px solid var(--secondary);
  animation: fadeInUp 0.6s ease-out;
}

.calculator-matrix {
  display: grid;
  gap: 10px;
  margin: 15px 0;
}

.calculator-row {
  display: flex;
  gap: 10px;
  justify-content: center;
}

.calculator-input {
  width: 60px;
  height: 40px;
  text-align: center;
  border: 1px solid rgba(100, 150, 250, 0.3);
  border-radius: 6px;
  background: rgba(100, 150, 250, 0.1);
  color: var(--ink);
}

[data-theme="light"] .calculator-input {
  background: rgba(59, 130, 246, 0.05);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.progress-indicator {
  position: fixed;
  bottom: 80px;
  right: 20px;
  background: rgba(42, 49, 66, 0.9);
  border-radius: 10px;
  padding: 10px 15px;
  font-size: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(100, 150, 250, 0.3);
}

[data-theme="light"] .progress-indicator {
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.navigation-minimap {
  position: fixed;
  top: 50%;
  right: 20px;
  transform: translateY(-50%);
  background: rgba(42, 49, 66, 0.9);
  border-radius: 10px;
  padding: 15px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(100, 150, 250, 0.3);
  display: flex;
  flex-direction: column;
  gap: 5px;
}

[data-theme="light"] .navigation-minimap {
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.minimap-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--muted);
  cursor: pointer;
  transition: all 0.3s ease;
}

.minimap-dot.active {
  background: var(--primary);
  transform: scale(1.2);
}

.minimap-dot:hover {
  background: var(--secondary);
}

.interactive-slider {
  margin: 20px 0;
  padding: 20px;
  background: rgba(100, 150, 250, 0.1);
  border-radius: 12px;
  border: 1px solid rgba(100, 150, 250, 0.3);
}

[data-theme="light"] .interactive-slider {
  background: rgba(59, 130, 246, 0.05);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.slider-control {
  width: 100%;
  margin: 10px 0;
}

.visualization-3d {
  width: 100%;
  height: 300px;
  background: rgba(100, 150, 250, 0.1);
  border-radius: 12px;
  border: 1px solid rgba(100, 150, 250, 0.3);
  margin: 20px 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'JetBrains Mono', monospace;
  color: var(--muted);
}

[data-theme="light"] .visualization-3d {
  background: rgba(59, 130, 246, 0.05);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

/* Modo pantalla completa */
body.fullscreen {
  padding: 0;
}

body.fullscreen .slides-container {
  height: 100vh;
}

/* Responsive */
@media (max-width: 768px) {
  .slide {
    padding: 40px 20px;
  }
  
  .brackets {
    font-size: 60px;
  }
  
  .left-bracket {
    left: 5%;
  }
  
  .right-bracket {
    right: 5%;
  }
  
  .nav-controls {
    bottom: 10px;
    padding: 10px 15px;
  }
  
  .nav-btn {
    padding: 10px 15px;
    min-width: 100px;
    font-size: 12px;
  }
  
  .week-grid {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .content-container {
    padding: 20px;
    max-height: 70vh;
  }
  
  .two-col, .three-col {
    grid-template-columns: 1fr;
  }
  
  .search-container, .theme-toggle, .navigation-minimap {
    position: static;
    margin: 10px;
  }
  
  .search-box {
    width: 100%;
  }
  
  .utility-controls {
    top: 10px;
    right: 10px;
  }
}

/* Animaciones */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-in {
  animation: fadeInUp 0.6s ease-out;
}

/* Estilos para elementos lazy */
.lazy-load {
  opacity: 0;
  transform: translateY(20px);
  transition: all 0.6s ease-out;
}

.lazy-load.loaded {
  opacity: 1;
  transform: translateY(0);
}

/* Nuevos estilos para la visualización 3D mejorada */
.threejs-controls-panel {
  background: rgba(42, 49, 66, 0.95);
  border-radius: 15px;
  padding: 20px;
  margin: 15px 0;
  border: 2px solid var(--primary);
  backdrop-filter: blur(10px);
}

.control-group {
  margin: 15px 0;
}

.control-label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: var(--secondary);
}

.preset-buttons {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin: 15px 0;
}

.preset-btn {
  background: rgba(100, 150, 250, 0.2);
  border: 1px solid rgba(100, 150, 250, 0.4);
  border-radius: 8px;
  padding: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 0.9rem;
}

.preset-btn:hover {
  background: rgba(100, 150, 250, 0.4);
  transform: translateY(-2px);
}

.visualization-stats {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin: 15px 0;
}

.stat-item {
  background: rgba(0, 212, 170, 0.1);
  border-radius: 8px;
  padding: 10px;
  text-align: center;
}

.stat-value {
  font-size: 1.2rem;
  font-weight: bold;
  color: var(--secondary);
}

.stat-label {
  font-size: 0.8rem;
  color: var(--muted);
}

/* Icono de accesibilidad flotante */
.accessibility-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: rgba(42, 49, 66, 0.9);
  border: 2px solid var(--secondary);
  border-radius: 50%;
  width: 60px;
  height: 60px;
  cursor: pointer;
  font-size: 1.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  color: var(--secondary);
}

[data-theme="light"] .accessibility-btn {
  background: rgba(255, 255, 255, 0.9);
  border: 2px solid var(--secondary);
}

.accessibility-btn:hover {
  background: var(--secondary);
  color: white;
  transform: scale(1.1);
}

/* Footer institucional */
.footer {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(26, 31, 46, 0.95);
  backdrop-filter: blur(10px);
  padding: 12px 20px;
  text-align: center;
  border-top: 1px solid rgba(100, 150, 250, 0.2);
  z-index: 50;
  font-size: 0.85rem;
  color: var(--muted);
  line-height: 1.4;
}

[data-theme="light"] .footer {
  background: rgba(248, 250, 252, 0.95);
  border-top: 1px solid rgba(59, 130, 246, 0.2);
}

.footer a {
  color: var(--secondary);
  text-decoration: none;
  transition: color 0.3s ease;
}

.footer a:hover {
  color: var(--primary);
  text-decoration: underline;
}

/* Modal de accesibilidad */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  z-index: 10000;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.modal.show {
  display: flex;
}

.modal-content {
  background: var(--panel);
  border: 3px solid var(--primary);
  border-radius: 25px;
  padding: 40px;
  max-width: 800px;
  max-height: 80vh;
  overflow-y: auto;
  color: var(--ink);
  box-shadow: 0 25px 60px rgba(0,0,0,0.5);
}

.modal-content h2 {
  color: var(--primary);
  margin-bottom: 20px;
  font-size: 2rem;
}

.modal-content h3 {
  color: var(--secondary);
  margin: 25px 0 15px 0;
  font-size: 1.5rem;
}

.modal-content p {
  line-height: 1.8;
  margin-bottom: 15px;
  color: var(--muted);
}

.modal-content ul {
  margin-left: 20px;
  margin-bottom: 15px;
  color: var(--muted);
}

.modal-content li {
  margin-bottom: 10px;
  line-height: 1.6;
}

.modal-close {
  background: var(--grad-primary);
  color: white;
  border: none;
  padding: 15px 30px;
  border-radius: 25px;
  cursor: pointer;
  margin-top: 25px;
  font-size: 1.1rem;
  font-weight: 700;
  width: 100%;
}

.wcag-badge {
  display: inline-block;
  background: var(--success);
  color: white;
  padding: 5px 12px;
  border-radius: 15px;
  font-size: 0.9rem;
  font-weight: 700;
  margin-left: 10px;
}

@media (max-width: 768px) {
  .accessibility-btn {
    bottom: 80px;
  }
  .footer {
    font-size: 0.75rem;
    padding: 10px 15px;
  }
}

</style>
<!-- MathJax Configuration -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    packages: {'[+]': ['ams', 'color']}
  },
  options: {
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    renderActions: {
      addMenu: [0, '', '']
    }
  },
  startup: {
    pageReady: () => {
      return MathJax.startup.defaultPageReady().then(() => {
        console.log('MathJax is ready');
      });
    }
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- Three.js Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
<!-- Barra de progreso -->
<div class="progress-bar">
  <div class="progress" id="progress"></div>
</div>

<!-- Controles de utilidad -->
<div class="utility-controls">
  <button class="util-btn" onclick="toggleFullscreen()" title="Pantalla completa">⛶</button>
  <button class="util-btn" onclick="zoomIn()" title="Acercar">+</button>
  <button class="util-btn" onclick="zoomOut()" title="Alejar">-</button>
  <button class="util-btn" onclick="resetZoom()" title="Tamaño normal">↺</button>
</div>

<!-- Búsqueda -->
<div class="search-container">
  <input type="text" class="search-box" id="searchInput" placeholder="🔍 Buscar en contenido..." onkeyup="searchContent(event)">
</div>

<!-- Toggle de tema -->
<div class="theme-toggle">
  <button class="theme-btn" onclick="toggleTheme()" title="Cambiar tema">🌓</button>
</div>

<!-- Mini mapa de navegación -->
<div class="navigation-minimap" id="navigationMinimap"></div>

<!-- Indicador de progreso personal -->
<div class="progress-indicator" id="progressIndicator">
  Progreso: <span id="userProgress">0%</span>
</div>

<!-- Contenedor de slides -->
<div class="slides-container" id="slidesContainer">
  
  <!-- PORTADA MEJORADA -->
  <div class="slide active" id="slide-0">
    <div class="cover-slide">
      <!-- Información institucional añadida -->
      <div style="position: absolute; top: 20px; left: 0; width: 100%; text-align: center; z-index: 10;">
        <h3 style="color: var(--muted); font-size: 1.1rem; margin-bottom: 5px; font-weight: 600;">
          Universidad del SABES
        </h3>
      </div>
      
      <!-- Grid animado de fondo -->
      <div class="matrix-grid-bg"></div>
      
      <!-- Partículas flotantes -->
      <div class="particles" id="particles"></div>
      
      <!-- Símbolos matemáticos flotantes -->
      <div class="floating-symbols">
        <div class="symbol">[</div>
        <div class="symbol">]</div>
        <div class="symbol">∑</div>
        <div class="symbol">∫</div>
        <div class="symbol">∂</div>
        <div class="symbol">∆</div>
      </div>
      
      <!-- Brackets de matriz -->
      <div class="brackets left-bracket">[</div>
      <div class="brackets right-bracket">]</div>
      
      <!-- Contenido principal - Ajustado para mejor espaciado -->
      <div style="position: relative; z-index: 2; width: 100%; max-width: 900px; margin-top: 40px;">
        <h1 class="cover-title" style="margin-bottom: 15px;">ÁLGEBRA LINEAL</h1>
        <h2 class="cover-subtitle" style="margin-bottom: 30px;">UNIDAD I: MATRICES Y DETERMINANTES</h2>
        
        <div class="learning-objectives" style="margin: 20px auto;">
          <h3>🎯 APRENDIZAJES ESPERADOS</h3>
          <p style="font-size: 1.1rem; line-height: 1.6;">
            Aplicar las matrices, los determinantes y operaciones entre ellas, para resolver 
            problemas en las diferentes áreas de las matemáticas y de la ingeniería.
          </p>
        </div>
        
        <div class="cta-button" style="margin-top: 30px;">
          <button class="glow-button" onclick="goToSlide(1)">
            <span>Comenzar Presentación</span> →
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Índice de semanas -->
  <div class="slide" id="slide-1">
    <h2 class="section-title">UNIDAD I: MATRICES Y DETERMINANTES</h2>
    <p style="text-align: center; color: var(--muted); margin-bottom: 40px; max-width: 800px;">
      Selecciona una semana para explorar los contenidos específicos de cada tema
    </p>
    
    <div class="week-grid">
      <a class="week-card" onclick="goToSlide(2)">
        <div class="week-number">01</div>
        <div class="week-title">Introducción a Matrices</div>
        <div class="week-topics">
          • Definición y notación<br>
          • Tipos de matrices<br>
          • Clasificación<br>
          • Matrices especiales
        </div>
      </a>
      
      <a class="week-card" onclick="goToSlide(3)">
        <div class="week-number">02</div>
        <div class="week-title">Operaciones con Matrices</div>
        <div class="week-topics">
          • Suma y resta<br>
          • Multiplicación por escalar<br>
          • Producto matricial<br>
          • Propiedades
        </div>
      </a>
      
      <a class="week-card" onclick="goToSlide(4)">
        <div class="week-number">03</div>
        <div class="week-title">Transformaciones Elementales</div>
        <div class="week-topics">
          • Operaciones elementales<br>
          • Matriz inversa<br>
          • Método de Gauss-Jordan<br>
          • Determinantes
        </div>
      </a>
      
      <a class="week-card" onclick="goToSlide(5)">
        <div class="week-number">04</div>
        <div class="week-title">Propiedades y Aplicaciones</div>
        <div class="week-topics">
          • Propiedades de determinantes<br>
          • Regla de Cramer<br>
          • Aplicaciones prácticas<br>
          • Casos de estudio
        </div>
      </a>
      
      <a class="week-card" onclick="goToSlide(6)">
        <div class="week-number">🎯</div>
        <div class="week-title">Caso Práctico</div>
        <div class="week-topics">
          • Optimización de producción<br>
          • Aplicación industrial<br>
          • Solución paso a paso<br>
          • Análisis de resultados
        </div>
      </a>
      
      <a class="week-card" onclick="goToSlide(7)">
        <div class="week-number">📚</div>
        <div class="week-title">Bibliografía</div>
        <div class="week-topics">
          • Textos fundamentales<br>
          • Recursos digitales<br>
          • Software especializado<br>
          • Guías de estudio
        </div>
      </a>
    </div>
  </div>
  
  <!-- Semana 1 - Contenido Completo -->
  <div class="slide" id="slide-2">
    <div class="content-container">
      <div class="week-section">
        <div class="week-badge">Semana 1</div>
        <h2>1.1 Matrices</h2>
        
        <h3>1.1.1 Definición de matriz, notación y orden</h3>
        
        <div class="card">
          <div class="definition-box">
            <strong>Definición:</strong> Según Anton (2013), una matriz es un arreglo rectangular de números colocados en filas y columnas.
          </div>
          
          <div class="example-box">
            <strong>Representación general:</strong><br>
            Una matriz $A$ de orden $m \times n$ se representa como:
            $$A = \begin{pmatrix}
            a_{11} & a_{12} & \cdots & a_{1n} \\
            a_{21} & a_{22} & \cdots & a_{2n} \\
            \vdots & \vdots & \ddots & \vdots \\
            a_{m1} & a_{m2} & \cdots & a_{mn}
            \end{pmatrix}$$
          </div>
          
          <div class="example-box">
            <strong>Ejemplo 1:</strong> Matriz de orden $2 \times 3$<br>
            $$A = \begin{pmatrix}
            4 & -2 & 7 \\
            5 & 9 & 0
            \end{pmatrix}$$
          </div>
          
          <div class="example-box">
            <strong>Ejemplo 2:</strong> Matriz cuadrada de orden $3 \times 3$<br>
            $$B = \begin{pmatrix}
            2 & 0 & -1 \\
            3 & 4 & 5 \\
            -2 & 7 & 8
            \end{pmatrix}$$
          </div>
        </div>
        
        <h3>1.1.2 Clasificación de matrices</h3>
        
        <div class="two-col">
          <div class="card">
            <h4>📐 Matrices cuadradas</h4>
            <p>Una matriz cuadrada tiene igual número de filas y columnas.</p>
            <div class="example-box">
              <strong>Ejemplo:</strong><br>
              $$A = \begin{pmatrix}
              3 & -1 & 4 \\
              2 & 5 & 7 \\
              0 & 8 & -2
              \end{pmatrix}$$
            </div>
          </div>
          
          <div class="card">
            <h4>📏 Matrices rectangulares</h4>
            <p>Una matriz rectangular tiene diferente número de filas y columnas.</p>
            <div class="example-box">
              <strong>Ejemplo:</strong><br>
              $$B = \begin{pmatrix}
              1 & 4 & -2 & 5 \\
              7 & 3 & 0 & 6
              \end{pmatrix}$$
            </div>
          </div>
        </div>
        
        <h3>1.1.3 Tipos de matrices</h3>
        
        <div class="three-col">
          <div class="card">
            <h4>0️⃣ Matriz nula</h4>
            <p>Todos sus elementos son cero.</p>
            <div class="example-box">
              $$0_{2 \times 3} = \begin{pmatrix}
              0 & 0 & 0 \\
              0 & 0 & 0
              \end{pmatrix}$$
            </div>
          </div>
          
          <div class="card">
            <h4>1️⃣ Matriz identidad</h4>
            <p>Unos en la diagonal principal, ceros en el resto.</p>
            <div class="example-box">
              $$I_3 = \begin{pmatrix}
              1 & 0 & 0 \\
              0 & 1 & 0 \\
              0 & 0 & 1
              \end{pmatrix}$$
            </div>
          </div>
          
          <div class="card">
            <h4>🔷 Matriz diagonal</h4>
            <p>Ceros fuera de la diagonal principal.</p>
            <div class="example-box">
              $$D = \begin{pmatrix}
              4 & 0 & 0 \\
              0 & -2 & 0 \\
              0 & 0 & 7
              \end{pmatrix}$$
            </div>
          </div>
        </div>
        
        <!-- Quiz interactivo para Semana 1 -->
        <div class="quiz-container">
          <h3>🧠 Autoevaluación - Semana 1</h3>
          <div class="quiz-question">
            1. ¿Cuál de las siguientes es una matriz cuadrada?
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">$\begin{pmatrix}1 & 2 \\ 3 & 4\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}1 & 2 & 3\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}1 \\ 2 \\ 3\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}1 & 2 \\ 3 & 4 \\ 5 & 6\end{pmatrix}$</div>
          </div>
          
          <div class="quiz-question">
            2. La matriz identidad de orden 2 es:
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}0 & 0 \\ 0 & 0\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">$\begin{pmatrix}1 & 0 \\ 0 & 1\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}1 & 1 \\ 1 & 1\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}2 & 0 \\ 0 & 2\end{pmatrix}$</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Semana 2 - Contenido Completo -->
  <div class="slide" id="slide-3">
    <div class="content-container">
      <div class="week-section">
        <div class="week-badge">Semana 2</div>
        <h2>1.1.4 Operaciones con Matrices</h2>
        
        <div class="citation">
          "Las operaciones con matrices permiten manipular y transformar datos organizados en forma matricial. Estas operaciones son fundamentales para resolver sistemas de ecuaciones lineales, realizar transformaciones geométricas, analizar datos multidimensionales y muchas otras aplicaciones en matemáticas, física, ingeniería, economía y ciencias computacionales." 
          <strong>Páez, C. (2013)</strong>
        </div>

        <!-- Calculadora matricial interactiva -->
        <div class="calculator-container">
          <h3>🧮 Calculadora Matricial</h3>
          <div class="two-col">
            <div>
              <h4>Matriz A (2×2)</h4>
              <div class="calculator-matrix">
                <div class="calculator-row">
                  <input type="number" class="calculator-input" id="a11" value="1">
                  <input type="number" class="calculator-input" id="a12" value="2">
                </div>
                <div class="calculator-row">
                  <input type="number" class="calculator-input" id="a21" value="3">
                  <input type="number" class="calculator-input" id="a22" value="4">
                </div>
              </div>
            </div>
            <div>
              <h4>Matriz B (2×2)</h4>
              <div class="calculator-matrix">
                <div class="calculator-row">
                  <input type="number" class="calculator-input" id="b11" value="5">
                  <input type="number" class="calculator-input" id="b12" value="6">
                </div>
                <div class="calculator-row">
                  <input type="number" class="calculator-input" id="b21" value="7">
                  <input type="number" class="calculator-input" id="b22" value="8">
                </div>
              </div>
            </div>
          </div>
          <div style="text-align: center; margin: 20px 0;">
            <button class="nav-btn" onclick="calculateMatrixOperation('add')">A + B</button>
            <button class="nav-btn" onclick="calculateMatrixOperation('multiply')">A × B</button>
            <button class="nav-btn" onclick="calculateMatrixOperation('determinant')">det(A)</button>
          </div>
          <div id="calculatorResult" class="math-display" style="min-height: 60px;">
            Resultado aparecerá aquí
          </div>
        </div>

        <!-- SUMA Y RESTA DE MATRICES -->
        <h3>Suma y Resta de Matrices</h3>
        
        <div class="two-col">
          <div class="card">
            <h4>➕ Suma de Matrices</h4>
            <div class="definition-box">
              <strong>Definición formal:</strong> Sean $A$ y $B$ dos matrices de orden $m \times n$. 
              La suma $A + B$ es una matriz de orden $m \times n$ donde:
              $$(A + B)_{ij} = a_{ij} + b_{ij}$$
              para todo $i = 1,2,\ldots,m$ y $j = 1,2,\ldots,n$.
            </div>
            
            <div class="example-box">
              <strong>Ejemplo:</strong><br>
              Si $A = \begin{pmatrix}2 & -1 \\ 3 & 4\end{pmatrix}$ y 
              $B = \begin{pmatrix}1 & 5 \\ -2 & 3\end{pmatrix}$<br><br>
              
              <div class="matrix-container">
                <div class="matrix">
                  <div class="matrix-grid matrix-2x2">
                    <div class="matrix-cell">2</div>
                    <div class="matrix-cell">-1</div>
                    <div class="matrix-cell">3</div>
                    <div class="matrix-cell">4</div>
                  </div>
                </div>
                
                <div class="operation-symbol">+</div>
                
                <div class="matrix">
                  <div class="matrix-grid matrix-2x2">
                    <div class="matrix-cell">1</div>
                    <div class="matrix-cell">5</div>
                    <div class="matrix-cell">-2</div>
                    <div class="matrix-cell">3</div>
                  </div>
                </div>
                
                <div class="operation-symbol">=</div>
                
                <div class="matrix">
                  <div class="matrix-grid matrix-2x2">
                    <div class="matrix-cell">3</div>
                    <div class="matrix-cell">4</div>
                    <div class="matrix-cell">1</div>
                    <div class="matrix-cell">7</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="card">
            <h4>➖ Resta de Matrices</h4>
            <div class="definition-box">
              <strong>Definición formal:</strong> Sean $A$ y $B$ dos matrices de orden $m \times n$. 
              La resta $A - B$ es una matriz de orden $m \times n$ donde:
              $$(A - B)_{ij} = a_{ij} - b_{ij}$$
              para todo $i = 1,2,\ldots,m$ y $j = 1,2,\ldots,n$.
            </div>
            
            <div class="example-box">
              <strong>Ejemplo:</strong><br>
              Usando las matrices anteriores:<br><br>
              
              <div class="matrix-container">
                <div class="matrix">
                  <div class="matrix-grid matrix-2x2">
                    <div class="matrix-cell">2</div>
                    <div class="matrix-cell">-1</div>
                    <div class="matrix-cell">3</div>
                    <div class="matrix-cell">4</div>
                  </div>
                </div>
                
                <div class="operation-symbol">-</div>
                
                <div class="matrix">
                  <div class="matrix-grid matrix-2x2">
                    <div class="matrix-cell">1</div>
                    <div class="matrix-cell">5</div>
                    <div class="matrix-cell">-2</div>
                    <div class="matrix-cell">3</div>
                  </div>
                </div>
                
                <div class="operation-symbol">=</div>
                
                <div class="matrix">
                  <div class="matrix-grid matrix-2x2">
                    <div class="matrix-cell">1</div>
                    <div class="matrix-cell">-6</div>
                    <div class="matrix-cell">5</div>
                    <div class="matrix-cell">1</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- PROPIEDADES DE LA SUMA -->
        <div class="property-box">
          <h4>📐 Propiedades de la Suma de Matrices</h4>
          <div class="two-col">
            <div>
              <strong>Conmutatividad:</strong> $A + B = B + A$<br>
              <strong>Asociatividad:</strong> $(A + B) + C = A + (B + C)$<br>
              <strong>Elemento neutro:</strong> $A + 0 = 0 + A = A$
            </div>
            <div>
              <strong>Elemento opuesto:</strong> $A + (-A) = (-A) + A = 0$<br>
              <strong>Transpuesta de la suma:</strong> $(A + B)^T = A^T + B^T$
            </div>
          </div>
        </div>

        <!-- MULTIPLICACIÓN POR ESCALAR -->
        <h3>Multiplicación por Escalar</h3>
        
        <div class="card">
          <div class="definition-box">
            <strong>Definición formal:</strong> Sea $A$ una matriz de orden $m \times n$ y $k$ un escalar. 
            El producto $kA$ es una matriz de orden $m \times n$ donde:
            $$(kA)_{ij} = k \cdot a_{ij}$$
            para todo $i = 1,2,\ldots,m$ y $j = 1,2,\ldots,n$.
          </div>
          
          <div class="example-box">
            <strong>Ejemplo:</strong> Si $k = 3$ y $A = \begin{pmatrix}2 & -1 \\ 3 & 4\end{pmatrix}$<br><br>
            
            <div class="matrix-container">
              <div style="font-size:1.5rem; color:var(--secondary);">3 ×</div>
              
              <div class="matrix">
                <div class="matrix-grid matrix-2x2">
                  <div class="matrix-cell">2</div>
                  <div class="matrix-cell">-1</div>
                  <div class="matrix-cell">3</div>
                  <div class="matrix-cell">4</div>
                </div>
              </div>
              
              <div class="operation-symbol">=</div>
              
              <div class="matrix">
                <div class="matrix-grid matrix-2x2">
                  <div class="matrix-cell">6</div>
                  <div class="matrix-cell">-3</div>
                  <div class="matrix-cell">9</div>
                  <div class="matrix-cell">12</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- PRODUCTO MATRICIAL -->
        <h3>Producto Matricial</h3>
        
        <div class="card">
          <div class="definition-box">
            <strong>Definición formal:</strong> Sea $A$ una matriz de orden $m \times n$ y $B$ una matriz de orden $n \times p$. 
            El producto $AB$ es una matriz de orden $m \times p$ donde:
            $$(AB)_{ij} = \sum_{k=1}^{n} a_{ik} \cdot b_{kj} = a_{i1}b_{1j} + a_{i2}b_{2j} + \cdots + a_{in}b_{nj}$$
            para todo $i = 1,2,\ldots,m$ y $j = 1,2,\ldots,p$.
          </div>
          
          <div class="citation">
            "El producto matricial representa la composición de transformaciones lineales, donde la matriz resultante codifica el efecto combinado de aplicar primero la transformación representada por B y luego la representada por A." 
            <strong>Lay, D. C. (2007)</strong>
          </div>
        </div>

        <!-- EJEMPLO DETALLADO DE PRODUCTO MATRICIAL -->
        <div class="step-by-step">
          <h4>🔍 Ejemplo Paso a Paso: Producto Matricial</h4>
          
          <div class="step">
            <span class="step-number">1</span>
            <strong>Matrices dadas:</strong><br>
            $A = \begin{pmatrix}2 & 3 \\ 1 & 0 \\ 4 & -1\end{pmatrix}$, 
            $B = \begin{pmatrix}1 & 2 & -1 \\ 0 & 3 & 5\end{pmatrix}$
          </div>
          
          <div class="step">
            <span class="step-number">2</span>
            <strong>Verificación de compatibilidad:</strong><br>
            $A$ es $3 \times 2$, $B$ es $2 \times 3$ → $AB$ será $3 \times 3$
          </div>
          
          <div class="step">
            <span class="step-number">3</span>
            <strong>Cálculo de elementos:</strong><br>
            $(AB)_{11} = 2\cdot1 + 3\cdot0 = 2$<br>
            $(AB)_{12} = 2\cdot2 + 3\cdot3 = 4 + 9 = 13$<br>
            $(AB)_{13} = 2\cdot(-1) + 3\cdot5 = -2 + 15 = 13$
          </div>
          
          <div class="step">
            <span class="step-number">4</span>
            <strong>Resultado final:</strong><br>
            $AB = \begin{pmatrix}2 & 13 & 13 \\ 1 & 2 & -1 \\ 4 & 5 & -9\end{pmatrix}$
          </div>
        </div>

        <!-- PROPIEDADES DEL PRODUCTO MATRICIAL -->
        <div class="property-box">
          <h4>⚖️ Propiedades del Producto Matricial</h4>
          <div class="three-col">
            <div>
              <strong>Asociatividad:</strong><br>
              $(AB)C = A(BC)$
            </div>
            <div>
              <strong>Distributividad:</strong><br>
              $A(B + C) = AB + AC$<br>
              $(A + B)C = AC + BC$
            </div>
            <div>
              <strong>Elemento neutro:</strong><br>
              $AI = IA = A$
            </div>
          </div>
          
          <div style="margin-top:15px; text-align:center;">
            <strong style="color:var(--warn);">¡Importante! No conmutatividad:</strong><br>
            En general, $AB \neq BA$
          </div>
        </div>
        
        <!-- Quiz interactivo para Semana 2 -->
        <div class="quiz-container">
          <h3>🧠 Autoevaluación - Semana 2</h3>
          <div class="quiz-question">
            1. Si $A = \begin{pmatrix}1 & 2 \\ 3 & 4\end{pmatrix}$ y $B = \begin{pmatrix}2 & 0 \\ 1 & 2\end{pmatrix}$, ¿cuál es $A + B$?
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">$\begin{pmatrix}3 & 2 \\ 4 & 6\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}3 & 2 \\ 4 & 4\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}1 & 2 \\ 3 & 6\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}2 & 2 \\ 4 & 6\end{pmatrix}$</div>
          </div>
          
          <div class="quiz-question">
            2. ¿Es cierto que $AB = BA$ para todas las matrices cuadradas?
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Sí, siempre</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">No, en general no</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Solo para matrices diagonales</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Solo para matrices identidad</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Semana 3 - Contenido Completo -->
  <div class="slide" id="slide-4">
    <div class="content-container">
      <div class="week-section">
        <div class="week-badge">Semana 3</div>
        <h2>1.2 Transformaciones elementales por renglón</h2>
        
        <div class="citation">
          "Las transformaciones elementales por renglón son operaciones fundamentales que permiten manipular matrices sin alterar las propiedades esenciales de los sistemas de ecuaciones lineales que representan. Estas transformaciones son la base de numerosos algoritmos en álgebra lineal, desde la resolución de sistemas de ecuaciones hasta el cálculo de rangos, inversas y determinantes." 
          <strong>Sandoval Páez, L. I. (2012)</strong>
        </div>

        <!-- VISUALIZACIÓN 3D MEJORADA CON THREE.JS -->
        <div class="visualization-3d">
          <div style="text-align: center; width: 100%;">
            <h4>🎮 LABORATORIO 3D - TRANSFORMACIONES LINEALES</h4>
            
            <div class="threejs-controls-panel">
              <div class="two-col">
                <div>
                  <div class="control-group">
                    <label class="control-label">🔧 Tipo de Transformación</label>
                    <select class="util-btn" style="width: 100%;" onchange="changeTransformationType(this.value)">
                      <option value="rotation">Rotación 3D</option>
                      <option value="scale">Escalado 3D</option>
                      <option value="shear">Deformación</option>
                      <option value="reflection">Reflexión</option>
                      <option value="projection">Proyección</option>
                    </select>
                  </div>
                  
                  <div class="control-group">
                    <label class="control-label">🎯 Ejes de Transformación</label>
                    <div class="preset-buttons">
                      <button class="preset-btn" onclick="setTransformationAxis('x')">Eje X</button>
                      <button class="preset-btn" onclick="setTransformationAxis('y')">Eje Y</button>
                      <button class="preset-btn" onclick="setTransformationAxis('z')">Eje Z</button>
                      <button class="preset-btn" onclick="setTransformationAxis('xy')">XY</button>
                      <button class="preset-btn" onclick="setTransformationAxis('xyz')">XYZ</button>
                      <button class="preset-btn" onclick="setTransformationAxis('custom')">Personalizado</button>
                    </div>
                  </div>
                </div>
                
                <div>
                  <div class="control-group">
                    <label class="control-label">🎛️ Intensidad: <span id="intensity-value">50</span>%</label>
                    <input type="range" class="slider-control" id="intensity-slider" min="0" max="100" value="50" oninput="updateTransformationIntensity(this.value)">
                  </div>
                  
                  <div class="control-group">
                    <label class="control-label">⚡ Velocidad: <span id="speed-value">1.0</span>x</label>
                    <input type="range" class="slider-control" id="speed-slider" min="0.1" max="3" step="0.1" value="1" oninput="updateAnimationSpeed(this.value)">
                  </div>
                  
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
                    <button class="preset-btn" onclick="startAnimation()">▶️ Animar</button>
                    <button class="preset-btn" onclick="resetTransformation()">🔁 Reiniciar</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Contenedor Three.js -->
            <div id="threejs-container" style="width: 100%; height: 300px; margin: 15px 0; 
                  border-radius: 12px; border: 3px solid var(--primary); 
                  background: linear-gradient(135deg, var(--panel), #1a1f2e);
                  box-shadow: 0 8px 25px rgba(100, 150, 250, 0.3);
                  position: relative; overflow: hidden;">
              
              <div id="loading-3d" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                    text-align: center; color: var(--accent); z-index: 10;">
                <div style="font-size: 2.5rem; margin-bottom: 10px;">🔄</div>
                <h4 style="color: var(--accent); margin-bottom: 5px;">INICIANDO MOTORES 3D</h4>
                <p style="color: var(--muted); font-size: 0.9rem;">Cargando visualización avanzada...</p>
                <button class="glow-button" onclick="initAdvancedThreeJS()" style="margin-top: 15px; padding: 10px 20px;">
                  🚀 ACTIVAR VISUALIZACIÓN 3D
                </button>
              </div>
            </div>

            <!-- Panel de estadísticas y matriz -->
            <div class="visualization-stats">
              <div class="stat-item">
                <div class="stat-value" id="determinant-value">1.00</div>
                <div class="stat-label">Determinante</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="volume-value">1.00</div>
                <div class="stat-label">Volumen</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="fps-value">0</div>
                <div class="stat-label">FPS</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="rotation-value">0°</div>
                <div class="stat-label">Rotación</div>
              </div>
            </div>

            <!-- Matriz de transformación en tiempo real -->
            <div class="math-display" id="liveMatrix" style="font-size: 1rem; margin: 15px 0;">
              <strong>Matriz de Transformación Actual:</strong><br>
              $T = \begin{bmatrix}
              <span id="m11">1.00</span> & <span id="m12">0.00</span> & <span id="m13">0.00</span> \\
              <span id="m21">0.00</span> & <span id="m22">1.00</span> & <span id="m23">0.00</span> \\
              <span id="m31">0.00</span> & <span id="m32">0.00</span> & <span id="m33">1.00</span>
              \end{bmatrix}$
            </div>

            <!-- Controles adicionales -->
            <div class="preset-buttons">
              <button class="preset-btn" onclick="toggleGridVisibility()">📐 Cuadrícula</button>
              <button class="preset-btn" onclick="toggleAxisVisibility()">🧭 Ejes</button>
              <button class="preset-btn" onclick="toggleVectorsVisibility()">📏 Vectores</button>
              <button class="preset-btn" onclick="changeObjectType()">🎯 Objeto 3D</button>
              <button class="preset-btn" onclick="takeScreenshot()">📸 Capturar</button>
              <button class="preset-btn" onclick="toggleFullscreen3D()">⛶ Pantalla Completa</button>
            </div>
          </div>
        </div>

        <h3>1.2.1 Escalonamiento de una matriz</h3>
        
        <div class="card">
          <h4>🔄 Operaciones elementales</h4>
          <div class="definition-box">
            <strong>Tipos de operaciones elementales:</strong>
            <ol>
              <li><strong>Intercambiar dos filas:</strong> $F_i \leftrightarrow F_j$</li>
              <li><strong>Multiplicar una fila por un escalar no nulo:</strong> $F_i \rightarrow c \cdot F_i$</li>
              <li><strong>Sumar a una fila un múltiplo de otra fila:</strong> $F_i \rightarrow F_i + c \cdot F_j$</li>
            </ol>
          </div>
          
          <div class="example-box">
            <strong>Ejemplo de escalonamiento:</strong><br>
            Consideremos la matriz:
            $$A = \begin{pmatrix}
            2 & 1 & -1 & 8 \\
            -3 & -1 & 2 & -11 \\
            -2 & 1 & 2 & -3
            \end{pmatrix}$$
            
            <div class="step">
              <span class="step-number">1</span>
              Aplicando operaciones elementales, obtenemos la forma escalonada reducida:
              $$\begin{pmatrix}
              1 & 0 & 0 & 2 \\
              0 & 1 & 0 & 3 \\
              0 & 0 & 1 & -1
              \end{pmatrix}$$
            </div>
          </div>
        </div>

        <h3>1.2.2 Núcleo y rango de una matriz</h3>
        
        <div class="two-col">
          <div class="card">
            <h4>🎯 Núcleo (Espacio nulo)</h4>
            <div class="definition-box">
              <strong>Definición:</strong> El núcleo de una matriz $A$ de tamaño $m \times n$ es el conjunto de todos los vectores $\overrightarrow{x}$ en $\mathbb{R}^n$ tales que $A\overrightarrow{x} = \overrightarrow{0}$.
              $$\text{Núcleo}(A) = \{\overrightarrow{x} \in \mathbb{R}^n : A\overrightarrow{x} = \overrightarrow{0}\}$$
            </div>
            
            <div class="example-box">
              <strong>Ejemplo:</strong><br>
              Para $A = \begin{pmatrix}1 & 2 & 3 & 4 \\ 2 & 4 & 6 & 8 \\ 3 & 6 & 8 & 10\end{pmatrix}$<br>
              Una base para el núcleo es:
              $$\left\{ \begin{pmatrix}-2 \\ 1 \\ 0 \\ 0\end{pmatrix}, \begin{pmatrix}-4 \\ 0 \\ -1 \\ 1\end{pmatrix} \right\}$$
            </div>
          </div>
          
          <div class="card">
            <h4>📊 Rango de una matriz</h4>
            <div class="definition-box">
              <strong>Definición:</strong> El rango de una matriz es la dimensión del espacio generado por sus vectores columna, o equivalentemente, por sus vectores fila.
            </div>
            
            <div class="example-box">
              <strong>Ejemplo:</strong><br>
              Para la matriz anterior $A$, su forma escalonada reducida es:
              $$\begin{pmatrix}
              1 & 2 & 3 & 4 \\
              0 & 0 & 0 & 0 \\
              0 & 0 & 1 & 1
              \end{pmatrix}$$
              Hay 2 filas no nulas, por lo tanto, el rango de $A$ es 2.
            </div>
          </div>
        </div>

        <div class="property-box">
          <h4>📐 Teorema de la dimensión</h4>
          <p>Para una matriz $A$ de tamaño $m \times n$:</p>
          <div class="math-display">
            $\text{dim}(\text{Núcleo}(A)) + \text{rango}(A) = n$
          </div>
          <p>Donde $n$ es el número de columnas de $A$.</p>
        </div>

        <h3>1.2.3 Inversa de una matriz</h3>
        
        <div class="card">
          <div class="definition-box">
            <strong>Definición:</strong> Una matriz cuadrada $A$ de orden $n \times n$ es invertible si existe una matriz $B$ tal que:
            $$AB = BA = I_n$$
            donde $I_n$ es la matriz identidad de orden $n \times n$.
          </div>
          
          <div class="example-box">
            <strong>Ejemplo:</strong><br>
            Si $A = \begin{pmatrix}2 & 1 \\ 5 & 3\end{pmatrix}$, entonces su inversa es:
            $$A^{-1} = \begin{pmatrix}3 & -1 \\ -5 & 2\end{pmatrix}$$
            
            <div class="matrix-container">
              <div class="matrix">
                <div class="matrix-grid matrix-2x2">
                  <div class="matrix-cell">2</div>
                  <div class="matrix-cell">1</div>
                  <div class="matrix-cell">5</div>
                  <div class="matrix-cell">3</div>
                </div>
              </div>
              
              <div class="operation-symbol">×</div>
              
              <div class="matrix">
                <div class="matrix-grid matrix-2x2">
                  <div class="matrix-cell">3</div>
                  <div class="matrix-cell">-1</div>
                  <div class="matrix-cell">-5</div>
                  <div class="matrix-cell">2</div>
                </div>
              </div>
              
              <div class="operation-symbol">=</div>
              
              <div class="matrix">
                <div class="matrix-grid matrix-2x2">
                  <div class="matrix-cell">1</div>
                  <div class="matrix-cell">0</div>
                  <div class="matrix-cell">0</div>
                  <div class="matrix-cell">1</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <h3>1.2.4 Método de Gauss-Jordan para calcular la inversa</h3>
        
        <div class="step-by-step">
          <h4>🔍 Método de Gauss-Jordan paso a paso</h4>
          
          <div class="step">
            <span class="step-number">1</span>
            <strong>Matriz aumentada:</strong><br>
            Dada $A = \begin{pmatrix}2 & 1 \\ 5 & 3\end{pmatrix}$, formamos:
            $$\left(\begin{array}{cc|cc}
            2 & 1 & 1 & 0 \\
            5 & 3 & 0 & 1
            \end{array}\right)$$
          </div>
          
          <div class="step">
            <span class="step-number">2</span>
            <strong>Primera operación:</strong><br>
            $F_1 \rightarrow \frac{1}{2}F_1$:
            $$\left(\begin{array}{cc|cc}
            1 & 0.5 & 0.5 & 0 \\
            5 & 3 & 0 & 1
            \end{array}\right)$$
          </div>
          
          <div class="step">
            <span class="step-number">3</span>
            <strong>Segunda operación:</strong><br>
            $F_2 \rightarrow F_2 - 5F_1$:
            $$\left(\begin{array}{cc|cc}
            1 & 0.5 & 0.5 & 0 \\
            0 & 0.5 & -2.5 & 1
            \end{array}\right)$$
          </div>
          
          <div class="step">
            <span class="step-number">4</span>
            <strong>Tercera operación:</strong><br>
            $F_2 \rightarrow 2F_2$:
            $$\left(\begin{array}{cc|cc}
            1 & 0.5 & 0.5 & 0 \\
            0 & 1 & -5 & 2
            \end{array}\right)$$
          </div>
          
          <div class="step">
            <span class="step-number">5</span>
            <strong>Cuarta operación:</strong><br>
            $F_1 \rightarrow F_1 - 0.5F_2$:
            $$\left(\begin{array}{cc|cc}
            1 & 0 & 3 & -1 \\
            0 & 1 & -5 & 2
            \end{array}\right)$$
          </div>
          
          <div class="step">
            <span class="step-number">6</span>
            <strong>Resultado:</strong><br>
            La inversa es:
            $$A^{-1} = \begin{pmatrix}3 & -1 \\ -5 & 2\end{pmatrix}$$
          </div>
        </div>
        
        <!-- Quiz interactivo para Semana 3 -->
        <div class="quiz-container">
          <h3>🧠 Autoevaluación - Semana 3</h3>
          <div class="quiz-question">
            1. ¿Cuál de las siguientes NO es una operación elemental por renglón?
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Intercambiar dos filas</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Multiplicar una fila por un escalar</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">Multiplicar dos filas entre sí</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Sumar un múltiplo de una fila a otra</div>
          </div>
          
          <div class="quiz-question">
            2. Una matriz es invertible si y solo si:
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Es cuadrada</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">Su determinante es diferente de cero</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Tiene rango completo</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Todas las anteriores</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Semana 4 - Contenido Completo -->
  <div class="slide" id="slide-5">
    <div class="content-container">
      <div class="week-section">
        <div class="week-badge">Semana 4</div>
        <h2>1.3 Determinantes</h2>
        
        <div class="citation">
          "El determinante es una función que asigna a cada matriz cuadrada un número real. Esta función tiene propiedades geométricas importantes: el valor absoluto del determinante de una matriz representa el factor por el cual la transformación lineal asociada escala áreas o volúmenes, y su signo indica si la transformación preserva o invierte la orientación." 
          <strong>Poole, D. (2011)</strong>
        </div>

        <!-- Ejemplo interactivo con sliders -->
        <div class="interactive-slider">
          <h3>📐 Visualización Interactiva del Determinante</h3>
          <p>Mueve los sliders para ver cómo cambia el área del paralelogramo:</p>
          <div class="two-col">
            <div>
              <label>Vector u: (<span id="u1-value">1</span>, <span id="u2-value">0</span>)</label>
              <input type="range" class="slider-control" id="u1-slider" min="-3" max="3" step="0.1" value="1" oninput="updateDeterminantVisualization()">
              <input type="range" class="slider-control" id="u2-slider" min="-3" max="3" step="0.1" value="0" oninput="updateDeterminantVisualization()">
            </div>
            <div>
              <label>Vector v: (<span id="v1-value">0</span>, <span id="v2-value">1</span>)</label>
              <input type="range" class="slider-control" id="v1-slider" min="-3" max="3" step="0.1" value="0" oninput="updateDeterminantVisualization()">
              <input type="range" class="slider-control" id="v2-slider" min="-3" max="3" step="0.1" value="1" oninput="updateDeterminantVisualization()">
            </div>
          </div>
          <div class="math-display">
            $\text{det} = \begin{vmatrix} <span id="u1-display">1</span> & <span id="v1-display">0</span> \\ <span id="u2-display">0</span> & <span id="v2-display">1</span> \end{vmatrix} = <span id="determinant-value">1</span>$
          </div>
          <div class="visualization-3d">
            <div style="text-align: center;">
              <h4>Área del Paralelogramo: <span id="area-value">1</span> unidades²</h4>
              <p style="font-size: 0.9rem; color: var(--muted);">(Visualización del paralelogramo formado por los vectores)</p>
            </div>
          </div>
        </div>

        <h3>1.3.1 Definición y propiedades</h3>
        
        <div class="card">
          <div class="definition-box">
            <strong>Definición:</strong> El determinante de una matriz cuadrada $A$ es un escalar que se denota como $\det(A)$ o $|A|$.
          </div>
          
          <div class="example-box">
            <strong>Para matrices 2×2:</strong><br>
            Si $A = \begin{pmatrix}a & b \\ c & d\end{pmatrix}$, entonces:
            $$\det(A) = ad - bc$$
            
            <div class="matrix-container">
              <div class="matrix">
                <div class="matrix-grid matrix-2x2">
                  <div class="matrix-cell">a</div>
                  <div class="matrix-cell">b</div>
                  <div class="matrix-cell">c</div>
                  <div class="matrix-cell">d</div>
                </div>
              </div>
              
              <div class="operation-symbol">→</div>
              
              <div style="font-size:1.5rem; color:var(--secondary);">
                ad - bc
              </div>
            </div>
          </div>
          
          <div class="example-box">
            <strong>Para matrices 3×3 (Regla de Sarrus):</strong><br>
            Si $A = \begin{pmatrix}a & b & c \\ d & e & f \\ g & h & i\end{pmatrix}$, entonces:
            $$\det(A) = aei + bfg + cdh - ceg - bdi - afh$$
          </div>
        </div>

        <h3>1.3.2 Cálculo de determinantes</h3>
        
        <div class="two-col">
          <div class="card">
            <h4>📐 Método de cofactores</h4>
            <p>Para una matriz $A$ de orden $n \times n$, el determinante se puede calcular como:</p>
            <div class="math-display">
              $\det(A) = \sum_{j=1}^{n} a_{ij} \cdot C_{ij}$
            </div>
            <p>donde $C_{ij}$ es el cofactor de $a_{ij}$.</p>
            
            <div class="example-box">
              <strong>Ejemplo:</strong><br>
              Para $A = \begin{pmatrix}2 & 1 & 3 \\ 0 & 4 & -1 \\ 5 & 2 & 1\end{pmatrix}$<br>
              Expandiendo por la primera fila:
              $$\det(A) = 2 \cdot \begin{vmatrix}4 & -1 \\ 2 & 1\end{vmatrix} - 1 \cdot \begin{vmatrix}0 & -1 \\ 5 & 1\end{vmatrix} + 3 \cdot \begin{vmatrix}0 & 4 \\ 5 & 2\end{vmatrix}$$
              $$= 2(4\cdot1 - (-1)\cdot2) - 1(0\cdot1 - (-1)\cdot5) + 3(0\cdot2 - 4\cdot5)$$
              $$= 2(4+2) - 1(0+5) + 3(0-20) = 12 - 5 - 60 = -53$$
            </div>
          </div>
          
          <div class="card">
            <h4>🔍 Propiedades de los determinantes</h4>
            <div class="definition-box">
              <ol>
                <li>$\det(I) = 1$</li>
                <li>$\det(A^T) = \det(A)$</li>
                <li>$\det(AB) = \det(A)\det(B)$</li>
                <li>Si una fila/columna es cero, $\det(A) = 0$</li>
                <li>Si se intercambian dos filas, $\det(A)$ cambia de signo</li>
                <li>Si una fila es múltiplo de otra, $\det(A) = 0$</li>
                <li>$\det(kA) = k^n \det(A)$</li>
              </ol>
            </div>
          </div>
        </div>

        <h3>1.3.3 Aplicaciones de los determinantes</h3>
        
        <div class="three-col">
          <div class="card">
            <h4>🎯 Inversa de una matriz</h4>
            <p>Una matriz $A$ es invertible si y solo si $\det(A) \neq 0$.</p>
            <div class="math-display">
              $A^{-1} = \frac{1}{\det(A)} \text{adj}(A)$
            </div>
          </div>
          
          <div class="card">
            <h4>📊 Regla de Cramer</h4>
            <p>Para resolver $AX = B$:</p>
            <div class="math-display">
              $x_i = \frac{\det(A_i)}{\det(A)}$
            </div>
            <p>donde $A_i$ es $A$ con la columna $i$ reemplazada por $B$.</p>
          </div>
          
          <div class="card">
            <h4>📐 Área y volumen</h4>
            <p>El área del paralelogramo generado por vectores $\vec{u}$ y $\vec{v}$ es:</p>
            <div class="math-display">
              $\text{Área} = |\det(\vec{u}, \vec{v})|$
            </div>
          </div>
        </div>
        
        <!-- Quiz interactivo para Semana 4 -->
        <div class="quiz-container">
          <h3>🧠 Autoevaluación - Semana 4</h3>
          <div class="quiz-question">
            1. El determinante de $\begin{pmatrix}2 & 3 \\ 1 & 4\end{pmatrix}$ es:
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">5</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">11</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">8</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">-5</div>
          </div>
          
          <div class="quiz-question">
            2. Si el determinante de una matriz es cero, entonces:
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">La matriz es identidad</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">La matriz no es invertible</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">La matriz es simétrica</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">La matriz es diagonal</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Caso Práctico - Contenido Completo -->
  <div class="slide" id="slide-6">
    <div class="content-container">
      <div class="application-section">
        <h2>🎯 Ejercicio de Aplicación: Optimización de Producción en una Fábrica de Muebles</h2>
        
        <div class="citation">
          "Este ejercicio demuestra la aplicación práctica de matrices y determinantes en problemas reales de optimización industrial."
          <strong>Caso práctico adaptado de Hillier & Lieberman (2015)</strong>
        </div>

        <div class="card">
          <h4>📊 Contexto del Problema</h4>
          <p>Una fábrica de muebles produce tres tipos de productos: <span class="highlight">mesas</span>, <span class="highlight">sillas</span> y <span class="highlight">estanterías</span>. Cada producto requiere diferentes cantidades de tres recursos:</p>
          
          <div class="two-col">
            <div class="example-box">
              <strong>Matriz de recursos (A):</strong><br>
              $$A = \begin{pmatrix}
              4 & 1 & 6 \\
              3 & 1.5 & 2 \\
              2 & 1 & 3
              \end{pmatrix}$$
              <div style="text-align: center; color: var(--muted); font-size: 0.9rem;">
                Madera (kg) · Mano obra (h) · Máquinas (h)
              </div>
            </div>
            
            <div class="example-box">
              <strong>Recursos disponibles (b):</strong><br>
              $$b = \begin{pmatrix}
              220 \\
              140 \\
              100
              \end{pmatrix}$$
              <div style="text-align: center; color: var(--muted); font-size: 0.9rem;">
                Madera · Mano obra · Máquinas
              </div>
            </div>
          </div>
        </div>

        <div class="step-by-step">
          <h4>🧮 Solución Paso a Paso</h4>
          
          <div class="step">
            <span class="step-number">1</span>
            <strong>Formulación del Sistema:</strong><br>
            El problema se modela como $A \times x = b$<br>
            <div class="math-display">
              $\begin{pmatrix}
              4 & 1 & 6 \\
              3 & 1.5 & 2 \\
              2 & 1 & 3
              \end{pmatrix}
              \begin{pmatrix}
              x_1 \\ x_2 \\ x_3
              \end{pmatrix}
              =
              \begin{pmatrix}
              220 \\ 140 \\ 100
              \end{pmatrix}$
            </div>
          </div>

          <div class="step">
            <span class="step-number">2</span>
            <strong>Verificación de Factibilidad:</strong><br>
            Cálculo del determinante:
            <div class="math-display">
              $\det(A) = 4(1.5 \times 3 - 2 \times 1) - 1(3 \times 3 - 2 \times 2) + 6(3 \times 1 - 1.5 \times 2)$
            </div>
            <div class="math-display">
              $= 4(4.5 - 2) - 1(9 - 4) + 6(3 - 3) = 4(2.5) - 5 + 0 = 10 - 5 = 5 \neq 0$
            </div>
            <div class="property-box">
              <strong>✅ Conclusión:</strong> El sistema tiene solución única.
            </div>
          </div>

          <div class="step">
            <span class="step-number">3</span>
            <strong>Resolución por Gauss-Jordan:</strong><br>
            Matriz aumentada y operaciones elementales:
            <div class="math-display">
              $\left(\begin{array}{ccc|c}
              4 & 1 & 6 & 220 \\
              3 & 1.5 & 2 & 140 \\
              2 & 1 & 3 & 100
              \end{array}\right)$
            </div>
            <p>Después de aplicar operaciones elementales, obtenemos:</p>
            <div class="math-display">
              $\begin{pmatrix}
              1 & 0 & 0 & 30 \\
              0 & 1 & 0 & 20 \\
              0 & 0 & 1 & 10
              \end{pmatrix}$
            </div>
          </div>
        </div>

        <div class="analysis-box">
          <h4>📈 Análisis de la Solución</h4>
          
          <div class="two-col">
            <div>
              <strong>Producción Óptima:</strong>
              <ul style="margin: 10px 0; padding-left: 20px;">
                <li><span class="highlight">30 mesas</span></li>
                <li><span class="highlight">20 sillas</span></li>
                <li><span class="highlight">10 estanterías</span></li>
              </ul>
            </div>
            
            <div>
              <strong>Uso de Recursos:</strong>
              <ul style="margin: 10px 0; padding-left: 20px;">
                <li>Madera: 200 kg (90.9%)</li>
                <li>Mano obra: 140 h (100%)</li>
                <li>Máquinas: 110 h (110%) ❌</li>
              </ul>
            </div>
          </div>
          
          <div class="property-box">
            <strong>⚠️ Problema Identificado:</strong> Se excede la capacidad de máquinas en 10 horas.
          </div>
        </div>

        <div class="step">
          <span class="step-number">4</span>
          <strong>Optimización con Restricciones:</strong><br>
          Ajustamos la producción para no exceder las horas máquina:
          <div class="math-display">
            $2x_1 + x_2 + 3x_3 \leq 100$
          </div>
          <p><strong>Solución ajustada:</strong> 25 mesas, 30 sillas, 5 estanterías</p>
        </div>

        <div class="conclusion-box">
          <h4>🎯 Conclusiones del Ejercicio</h4>
          
          <div class="two-col">
            <div>
              <strong>Aprendizajes Clave:</strong>
              <ul style="margin: 10px 0; padding-left: 20px;">
                <li>Los sistemas matriciales modelan problemas reales</li>
                <li>La factibilidad matemática ≠ factibilidad física</li>
                <li>Restricciones de no negatividad son esenciales</li>
                <li>Análisis de sensibilidad identifica oportunidades</li>
              </ul>
            </div>
            
            <div>
              <strong>Aplicaciones en la Industria:</strong>
              <ul style="margin: 10px 0; padding-left: 20px;">
                <li>Planificación de producción</li>
                <li>Gestión de recursos</li>
                <li>Optimización de beneficios</li>
                <li>Análisis de inversiones</li>
              </ul>
            </div>
          </div>
        </div>
        
        <!-- Examen final interactivo -->
        <div class="quiz-container">
          <h3>📝 Examen Final - Unidad I</h3>
          <div class="quiz-question">
            1. ¿Cuál es el resultado de $\begin{pmatrix}1 & 2 \\ 3 & 4\end{pmatrix} \times \begin{pmatrix}2 & 0 \\ 1 & 2\end{pmatrix}$?
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}2 & 0 \\ 3 & 8\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">$\begin{pmatrix}4 & 4 \\ 10 & 8\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}3 & 2 \\ 4 & 6\end{pmatrix}$</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">$\begin{pmatrix}2 & 4 \\ 6 & 8\end{pmatrix}$</div>
          </div>
          
          <div class="quiz-question">
            2. El determinante de $\begin{pmatrix}2 & 1 & 0 \\ 0 & 3 & 1 \\ 1 & 0 & 2\end{pmatrix}$ es:
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">6</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">11</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">8</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">13</div>
          </div>
          
          <div class="quiz-question">
            3. Una matriz es invertible si:
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Es cuadrada</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Tiene rango completo</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Su determinante es ≠ 0</div>
            <div class="quiz-option" onclick="checkAnswer(this, 'correct')">Todas las anteriores</div>
          </div>
          
          <div style="text-align: center; margin-top: 20px;">
            <button class="glow-button" onclick="calculateFinalScore()">Calificar Examen</button>
            <div id="finalScore" style="margin-top: 15px; font-size: 1.2rem; font-weight: bold;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Bibliografía - Contenido Completo -->
  <div class="slide" id="slide-7">
    <div class="content-container">
      <div class="bibliography-section">
        <h2>📚 Bibliografía y Recursos Recomendados</h2>
        
        <div class="citation">
          "Una sólida bibliografía es fundamental para profundizar en los conceptos y aplicaciones del álgebra lineal."
          <strong>Strang, G. (2016)</strong>
        </div>

        <div class="card">
          <h4>📖 Bibliografía Básica</h4>
          
          <div class="bibliography-category">Textos Fundamentales</div>
          
          <div class="bibliography-item">
            <strong>Grossman, S. I., & Flores Godoy, J. J. (2012).</strong><br>
            <em>Álgebra Lineal (7a ed.).</em> McGraw-Hill.<br>
            <span style="color: var(--muted);">Texto completo con aplicaciones prácticas y numerosos ejemplos resueltos.</span>
          </div>

          <div class="bibliography-item">
            <strong>Lay, D. C. (2007).</strong><br>
            <em>Álgebra Lineal y sus Aplicaciones (3a ed.).</em> Pearson Educación.<br>
            <span style="color: var(--muted);">Enfoque moderno con aplicaciones en ingeniería y ciencias.</span>
          </div>

          <div class="bibliography-item">
            <strong>Kolman, B., & Hill, D. R. (2006).</strong><br>
            <em>Álgebra Lineal (8a ed.).</em> Pearson Prentice Hall.<br>
            <span style="color: var(--muted);">Abundantes ejercicios y problemas aplicados.</span>
          </div>

          <div class="bibliography-category">Textos Avanzados y Especializados</div>

          <div class="bibliography-item">
            <strong>Strang, G. (2016).</strong><br>
            <em>Introduction to Linear Algebra (5a ed.).</em> Wellesley-Cambridge Press.<br>
            <span style="color: var(--muted);">Clásico moderno con enfoque intuitivo y aplicaciones.</span>
          </div>

          <div class="bibliography-item">
            <strong>Anton, H. (2013).</strong><br>
            <em>Álgebra Lineal.</em> Limusa Wiley.<br>
            <span style="color: var(--muted);">Tratamiento riguroso con demostraciones completas.</span>
          </div>

          <div class="bibliography-item">
            <strong>Barrera Mora, F. (2013).</strong><br>
            <em>Álgebra Lineal.</em> Grupo Editorial Patria.<br>
            <span style="color: var(--muted);">Enfoque accesible con ejemplos contextualizados.</span>
          </div>
        </div>

        <div class="card">
          <h4>🌐 Recursos Digitales y Plataformas</h4>
          
          <div class="bibliography-category">Plataformas de Aprendizaje</div>

          <div class="bibliography-item">
            <strong>Khan Academy - Álgebra Lineal</strong><br>
            <a href="https://es.khanacademy.org/math/linear-algebra" class="resource-link" target="_blank">https://es.khanacademy.org/math/linear-algebra</a><br>
            <span style="color: var(--muted);">Videos explicativos y ejercicios interactivos en español.</span>
          </div>

          <div class="bibliography-item">
            <strong>MIT OpenCourseWare - Linear Algebra</strong><br>
            <a href="https://ocw.mit.edu/courses/mathematics/18-06-linear-algebra-spring-2010/" class="resource-link" target="_blank">https://ocw.mit.edu/courses/18-06-linear-algebra-spring-2010/</a><br>
            <span style="color: var(--muted);">Curso completo del profesor Gilbert Strang con materiales gratuitos.</span>
          </div>

          <div class="bibliography-item">
            <strong>3Blue1Brown - Essence of Linear Algebra</strong><br>
            <a href="https://www.3blue1brown.com/topics/linear-algebra" class="resource-link" target="_blank">https://www.3blue1brown.com/topics/linear-algebra</a><br>
            <span style="color: var(--muted);">Serie de videos con visualizaciones intuitivas de conceptos clave.</span>
          </div>
        </div>

        <div class="conclusion-box">
          <h4>📋 Criterios de Selección</h4>
          <p>Esta bibliografía ha sido seleccionada considerando:</p>
          <ul style="margin: 10px 0; padding-left: 20px;">
            <li><strong>Rigor matemático</strong> y claridad expositiva</li>
            <li><strong>Enfoque aplicado</strong> a problemas reales</li>
            <li><strong>Disponibilidad</strong> en bibliotecas y plataformas digitales</li>
            <li><strong>Actualización</strong> de contenidos y métodos</li>
            <li><strong>Accesibilidad</strong> para diferentes niveles de estudio</li>
          </ul>
          <p style="margin-top: 15px; font-style: italic;">
            "La combinación de textos clásicos con recursos digitales modernos proporciona una formación completa en álgebra lineal."
          </p>
        </div>
        
        <!-- Estadísticas de progreso del usuario -->
        <div class="property-box">
          <h4>📊 Tu Progreso en la Unidad I</h4>
          <div class="two-col">
            <div>
              <strong>Tiempo total de estudio:</strong><br>
              <span id="studyTime">0 horas 0 minutos</span>
            </div>
            <div>
              <strong>Promedio en evaluaciones:</strong><br>
              <span id="averageScore">0%</span>
            </div>
          </div>
          <div style="margin-top: 15px;">
            <strong>Recomendaciones de estudio:</strong><br>
            <span id="studyRecommendations">Completa las evaluaciones para recibir recomendaciones personalizadas.</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Controles de navegación -->
<div class="nav-controls">
  <button class="nav-btn" onclick="goToStart()" id="startBtn">
    <span>⏮</span> Inicio
  </button>
  <button class="nav-btn" onclick="previousSlide()" id="prevBtn">
    <span>◀</span> Atrás
  </button>
  <button class="nav-btn" onclick="nextSlide()" id="nextBtn">
    Adelante <span>▶</span>
  </button>
  <button class="nav-btn" onclick="goToEnd()" id="endBtn">
    Fin <span>⏭</span>
  </button>
</div>

<script>
// Variables globales
let currentSlide = 0;
const totalSlides = document.querySelectorAll('.slide').length;
let zoomLevel = 1;
let userProgress = JSON.parse(localStorage.getItem('userProgress')) || {
  visitedSlides: new Set(),
  quizScores: {},
  startTime: Date.now(),
  totalStudyTime: 0
};
let searchIndex = [];

// Variables para Three.js
let scene, camera, renderer, cube, axes, grid;
let animationId = null;
let isAnimating = false;
let currentTransformationType = 'rotation';
let currentAxis = 'xyz';
let transformationIntensity = 0.5;
let animationSpeed = 1.0;

// Inicializar el índice de búsqueda
function initializeSearchIndex() {
  const slides = document.querySelectorAll('.slide');
  slides.forEach((slide, index) => {
    const content = slide.textContent || slide.innerText;
    const title = slide.querySelector('h1, h2, h3, h4')?.textContent || `Slide ${index}`;
    searchIndex.push({
      id: index,
      title: title,
      content: content.toLowerCase(),
      slide: slide
    });
  });
}

// Búsqueda en el contenido
function searchContent(event) {
  const query = event.target.value.toLowerCase();
  const results = searchIndex.filter(item => 
    item.content.includes(query) || item.title.toLowerCase().includes(query)
  );
  
  if (query.length > 2 && results.length > 0) {
    // Aquí podríamos mostrar resultados de búsqueda
    console.log('Resultados encontrados:', results.length);
    // Por ahora, solo navegamos al primer resultado
    if (results[0]) {
      goToSlide(results[0].id);
    }
  }
}

// Función para ir a un slide específico
function goToSlide(slideIndex) {
  if (slideIndex < 0 || slideIndex >= totalSlides) return;
  
  const slides = document.querySelectorAll('.slide');
  slides[currentSlide].classList.remove('active');
  slides[currentSlide].classList.add('previous');
  
  currentSlide = slideIndex;
  
  slides[currentSlide].classList.remove('previous');
  slides[currentSlide].classList.add('active');
  
  updateNavigation();
  updateProgress();
  updateUserProgress();
  refreshMath();
  
  // Carga lazy de contenido
  loadLazyContent();
  
  // Inicializar Three.js si estamos en el slide 4
  if (currentSlide === 3 && !renderer) {
    setTimeout(initAdvancedThreeJS, 500);
  }
}

// Función para el slide siguiente
function nextSlide() {
  goToSlide(currentSlide + 1);
}

// Función para el slide anterior
function previousSlide() {
  goToSlide(currentSlide - 1);
}

// Función para ir al inicio
function goToStart() {
  goToSlide(0);
}

// Función para ir al final
function goToEnd() {
  goToSlide(totalSlides - 1);
}

// Actualizar estado de los botones de navegación
function updateNavigation() {
  document.getElementById('prevBtn').disabled = currentSlide === 0;
  document.getElementById('nextBtn').disabled = currentSlide === totalSlides - 1;
  document.getElementById('startBtn').disabled = currentSlide === 0;
  document.getElementById('endBtn').disabled = currentSlide === totalSlides - 1;
  
  // Actualizar mini mapa
  updateMinimap();
}

// Actualizar barra de progreso
function updateProgress() {
  const progress = document.getElementById('progress');
  const progressPercent = ((currentSlide + 1) / totalSlides) * 100;
  progress.style.width = `${progressPercent}%`;
}

// Actualizar progreso del usuario
function updateUserProgress() {
  userProgress.visitedSlides.add(currentSlide);
  const progressPercent = (userProgress.visitedSlides.size / totalSlides) * 100;
  document.getElementById('userProgress').textContent = `${Math.round(progressPercent)}%`;
  
  // Guardar en localStorage
  localStorage.setItem('userProgress', JSON.stringify({
    ...userProgress,
    visitedSlides: Array.from(userProgress.visitedSlides)
  }));
}

// Actualizar mini mapa de navegación
function updateMinimap() {
  const minimap = document.getElementById('navigationMinimap');
  minimap.innerHTML = '';
  
  for (let i = 0; i < totalSlides; i++) {
    const dot = document.createElement('div');
    dot.className = `minimap-dot ${i === currentSlide ? 'active' : ''}`;
    dot.onclick = () => goToSlide(i);
    minimap.appendChild(dot);
  }
}

// Funciones de zoom
function zoomIn() {
  zoomLevel += 0.1;
  document.body.style.transform = `scale(${zoomLevel})`;
  document.body.style.transformOrigin = 'center center';
}

function zoomOut() {
  if (zoomLevel > 0.5) {
    zoomLevel -= 0.1;
    document.body.style.transform = `scale(${zoomLevel})`;
    document.body.style.transformOrigin = 'center center';
  }
}

function resetZoom() {
  zoomLevel = 1;
  document.body.style.transform = 'scale(1)';
}

// Función para pantalla completa
function toggleFullscreen() {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen().catch(err => {
      console.log(`Error attempting to enable fullscreen: ${err.message}`);
    });
    document.body.classList.add('fullscreen');
  } else {
    if (document.exitFullscreen) {
      document.exitFullscreen();
      document.body.classList.remove('fullscreen');
    }
  }
}

// Cambiar tema claro/oscuro
function toggleTheme() {
  const currentTheme = document.documentElement.getAttribute('data-theme');
  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
  document.documentElement.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
}

// Re-renderizar MathJax
function refreshMath() {
  if (window.MathJax) {
    MathJax.typesetPromise();
  }
}

// Verificar respuestas en quizzes
function checkAnswer(element, result) {
  const options = element.parentElement.querySelectorAll('.quiz-option');
  options.forEach(opt => {
    opt.classList.remove('correct', 'incorrect');
    opt.onclick = null; // Deshabilitar más clicks
  });
  
  element.classList.add(result);
  
  // Guardar resultado
  if (!userProgress.quizScores) userProgress.quizScores = {};
  const quizId = element.closest('.quiz-container').querySelector('h3').textContent;
  if (!userProgress.quizScores[quizId]) {
    userProgress.quizScores[quizId] = [];
  }
  userProgress.quizScores[quizId].push(result === 'correct' ? 1 : 0);
  
  localStorage.setItem('userProgress', JSON.stringify({
    ...userProgress,
    visitedSlides: Array.from(userProgress.visitedSlides)
  }));
}

// Calcular puntaje final del examen
function calculateFinalScore() {
  const correctAnswers = document.querySelectorAll('.quiz-option.correct').length;
  const totalQuestions = document.querySelectorAll('.quiz-question').length;
  const score = Math.round((correctAnswers / totalQuestions) * 100);
  
  document.getElementById('finalScore').textContent = `Puntuación: ${score}%`;
  document.getElementById('finalScore').style.color = score >= 70 ? 'var(--success)' : 'var(--danger)';
  
  // Actualizar estadísticas
  updateStatistics();
}

// Actualizar estadísticas del usuario
function updateStatistics() {
  const now = Date.now();
  const studyTime = now - userProgress.startTime;
  userProgress.totalStudyTime += studyTime;
  
  const hours = Math.floor(userProgress.totalStudyTime / 3600000);
  const minutes = Math.floor((userProgress.totalStudyTime % 3600000) / 60000);
  document.getElementById('studyTime').textContent = `${hours} horas ${minutes} minutos`;
  
  // Calcular promedio de quizzes
  let totalScore = 0;
  let totalQuizzes = 0;
  
  if (userProgress.quizScores) {
    Object.values(userProgress.quizScores).forEach(scores => {
      const quizScore = scores.reduce((a, b) => a + b, 0) / scores.length * 100;
      totalScore += quizScore;
      totalQuizzes++;
    });
  }
  
  const averageScore = totalQuizzes > 0 ? Math.round(totalScore / totalQuizzes) : 0;
  document.getElementById('averageScore').textContent = `${averageScore}%`;
  
  // Generar recomendaciones
  let recommendations = '';
  if (averageScore < 70) {
    recommendations = 'Te recomendamos repasar los conceptos básicos y practicar con más ejercicios.';
  } else if (averageScore < 85) {
    recommendations = 'Buen trabajo! Considera profundizar en aplicaciones prácticas.';
  } else {
    recommendations = 'Excelente desempeño! Estás listo para temas más avanzados.';
  }
  document.getElementById('studyRecommendations').textContent = recommendations;
}

// Calculadora matricial
function calculateMatrixOperation(operation) {
  const a11 = parseFloat(document.getElementById('a11').value) || 0;
  const a12 = parseFloat(document.getElementById('a12').value) || 0;
  const a21 = parseFloat(document.getElementById('a21').value) || 0;
  const a22 = parseFloat(document.getElementById('a22').value) || 0;
  
  const b11 = parseFloat(document.getElementById('b11').value) || 0;
  const b12 = parseFloat(document.getElementById('b12').value) || 0;
  const b21 = parseFloat(document.getElementById('b21').value) || 0;
  const b22 = parseFloat(document.getElementById('b22').value) || 0;
  
  let result;
  
  switch(operation) {
    case 'add':
      result = `\\begin{pmatrix}${a11 + b11} & ${a12 + b12} \\\\ ${a21 + b21} & ${a22 + b22}\\end{pmatrix}`;
      break;
    case 'multiply':
      result = `\\begin{pmatrix}${a11*b11 + a12*b21} & ${a11*b12 + a12*b22} \\\\ ${a21*b11 + a22*b21} & ${a21*b12 + a22*b22}\\end{pmatrix}`;
      break;
    case 'determinant':
      result = `\\det(A) = ${a11*a22 - a12*a21}`;
      break;
  }
  
  document.getElementById('calculatorResult').innerHTML = `$$${result}$$`;
  refreshMath();
}

// Visualización interactiva del determinante
function updateDeterminantVisualization() {
  const u1 = parseFloat(document.getElementById('u1-slider').value);
  const u2 = parseFloat(document.getElementById('u2-slider').value);
  const v1 = parseFloat(document.getElementById('v1-slider').value);
  const v2 = parseFloat(document.getElementById('v2-slider').value);
  
  document.getElementById('u1-value').textContent = u1;
  document.getElementById('u2-value').textContent = u2;
  document.getElementById('v1-value').textContent = v1;
  document.getElementById('v2-value').textContent = v2;
  
  document.getElementById('u1-display').textContent = u1;
  document.getElementById('u2-display').textContent = u2;
  document.getElementById('v1-display').textContent = v1;
  document.getElementById('v2-display').textContent = v2;
  
  const determinant = u1 * v2 - u2 * v1;
  document.getElementById('determinant-value').textContent = determinant;
  document.getElementById('area-value').textContent = Math.abs(determinant).toFixed(2);
  
  refreshMath();
}

// Carga lazy de contenido
function loadLazyContent() {
  const lazyElements = document.querySelectorAll('.lazy-load');
  lazyElements.forEach(element => {
    if (isElementInViewport(element) && !element.classList.contains('loaded')) {
      element.classList.add('loaded');
      // Aquí podríamos cargar contenido pesado como visualizaciones 3D
    }
  });
}

// Verificar si elemento está en viewport
function isElementInViewport(el) {
  const rect = el.getBoundingClientRect();
  return (
    rect.top >= 0 &&
    rect.left >= 0 &&
    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
  );
}

// =============================================================================
// THREE.JS VISUALIZATION - FUNCIONES AVANZADAS
// =============================================================================

function initAdvancedThreeJS() {
  const container = document.getElementById('threejs-container');
  const loadingElement = document.getElementById('loading-3d');
  
  if (!container) return;
  
  // Ocultar elemento de carga
  if (loadingElement) {
    loadingElement.style.display = 'none';
  }
  
  // Limpiar contenedor
  container.innerHTML = '';
  
  // Crear escena
  scene = new THREE.Scene();
  scene.background = new THREE.Color(0x1a1f2e);
  
  // Crear cámara
  camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
  camera.position.z = 5;
  
  // Crear renderizador
  renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(container.clientWidth, container.clientHeight);
  renderer.setClearColor(0x1a1f2e, 1);
  container.appendChild(renderer.domElement);
  
  // Crear geometría del cubo
  const geometry = new THREE.BoxGeometry(2, 2, 2);
  const material = new THREE.MeshPhongMaterial({ 
    color: 0x6496fa,
    specular: 0xffffff,
    shininess: 100,
    transparent: true,
    opacity: 0.8
  });
  
  cube = new THREE.Mesh(geometry, material);
  scene.add(cube);
  
  // Crear ejes coordenados
  const axesHelper = new THREE.AxesHelper(3);
  scene.add(axesHelper);
  axes = axesHelper;
  
  // Crear cuadrícula
  const gridHelper = new THREE.GridHelper(10, 10, 0x444444, 0x222222);
  scene.add(gridHelper);
  grid = gridHelper;
  
  // Agregar luces
  const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
  scene.add(ambientLight);
  
  const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
  directionalLight.position.set(5, 5, 5);
  scene.add(directionalLight);
  
  // Agregar luz puntual
  const pointLight = new THREE.PointLight(0x00d4aa, 0.5, 100);
  pointLight.position.set(0, 3, 3);
  scene.add(pointLight);
  
  // Iniciar animación
  animate();
  
  // Manejar redimensionamiento
  window.addEventListener('resize', onWindowResize);
}

function onWindowResize() {
  if (!camera || !renderer) return;
  
  const container = document.getElementById('threejs-container');
  camera.aspect = container.clientWidth / container.clientHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(container.clientWidth, container.clientHeight);
}

function animate() {
  animationId = requestAnimationFrame(animate);
  
  if (isAnimating && cube) {
    const time = Date.now() * 0.001 * animationSpeed;
    
    switch(currentTransformationType) {
      case 'rotation':
        applyRotation(time);
        break;
      case 'scale':
        applyScale(time);
        break;
      case 'shear':
        applyShear(time);
        break;
      case 'reflection':
        applyReflection(time);
        break;
      case 'projection':
        applyProjection(time);
        break;
    }
    
    updateStats();
  }
  
  if (renderer && scene && camera) {
    renderer.render(scene, camera);
  }
}

function applyRotation(time) {
  const intensity = transformationIntensity * 2;
  
  switch(currentAxis) {
    case 'x':
      cube.rotation.x = time * intensity;
      break;
    case 'y':
      cube.rotation.y = time * intensity;
      break;
    case 'z':
      cube.rotation.z = time * intensity;
      break;
    case 'xy':
      cube.rotation.x = time * intensity * 0.7;
      cube.rotation.y = time * intensity * 0.5;
      break;
    case 'xyz':
      cube.rotation.x = time * intensity * 0.5;
      cube.rotation.y = time * intensity * 0.7;
      cube.rotation.z = time * intensity * 0.3;
      break;
  }
}

function applyScale(time) {
  const scale = 1 + Math.sin(time) * transformationIntensity;
  
  switch(currentAxis) {
    case 'x':
      cube.scale.set(scale, 1, 1);
      break;
    case 'y':
      cube.scale.set(1, scale, 1);
      break;
    case 'z':
      cube.scale.set(1, 1, scale);
      break;
    case 'xy':
      cube.scale.set(scale, scale, 1);
      break;
    case 'xyz':
      cube.scale.set(scale, scale, scale);
      break;
  }
}

function applyShear(time) {
  // Implementación básica de cizalla usando matriz de transformación
  const shearAmount = Math.sin(time) * transformationIntensity * 0.5;
  
  const matrix = new THREE.Matrix4();
  matrix.set(
    1, shearAmount, 0, 0,
    shearAmount, 1, 0, 0,
    0, 0, 1, 0,
    0, 0, 0, 1
  );
  
  cube.matrixAutoUpdate = false;
  cube.matrix.copy(matrix);
}

function applyReflection(time) {
  const reflection = Math.sin(time) * transformationIntensity;
  
  if (Math.abs(reflection) > 0.8) {
    cube.scale.x = -Math.sign(reflection);
  } else {
    cube.scale.x = 1;
  }
}

function applyProjection(time) {
  // Simulación simple de proyección
  const projection = Math.sin(time) * transformationIntensity;
  cube.position.z = projection * 2;
}

function updateStats() {
  if (!cube) return;
  
  // Actualizar determinante (simulado)
  const determinant = Math.abs(cube.scale.x * cube.scale.y * cube.scale.z);
  document.getElementById('determinant-value').textContent = determinant.toFixed(2);
  
  // Actualizar volumen
  const volume = Math.abs(cube.scale.x * cube.scale.y * cube.scale.z * 8); // 2^3 = 8
  document.getElementById('volume-value').textContent = volume.toFixed(2);
  
  // Actualizar FPS (simulado)
  document.getElementById('fps-value').textContent = Math.round(1000/16); // 60 FPS aproximado
  
  // Actualizar rotación
  const rotation = Math.round((cube.rotation.x + cube.rotation.y + cube.rotation.z) * 180 / Math.PI);
  document.getElementById('rotation-value').textContent = rotation + '°';
  
  // Actualizar matriz de transformación
  updateMatrixDisplay();
}

function updateMatrixDisplay() {
  if (!cube) return;
  
  // Matriz de transformación simplificada
  document.getElementById('m11').textContent = cube.scale.x.toFixed(2);
  document.getElementById('m22').textContent = cube.scale.y.toFixed(2);
  document.getElementById('m33').textContent = cube.scale.z.toFixed(2);
  
  // Actualizar MathJax
  refreshMath();
}

// Controladores de la interfaz
function changeTransformationType(type) {
  currentTransformationType = type;
  resetTransformation();
}

function setTransformationAxis(axis) {
  currentAxis = axis;
}

function updateTransformationIntensity(value) {
  transformationIntensity = value / 100;
  document.getElementById('intensity-value').textContent = value;
}

function updateAnimationSpeed(value) {
  animationSpeed = parseFloat(value);
  document.getElementById('speed-value').textContent = value;
}

function startAnimation() {
  isAnimating = true;
}

function resetTransformation() {
  if (cube) {
    cube.rotation.set(0, 0, 0);
    cube.scale.set(1, 1, 1);
    cube.position.set(0, 0, 0);
    cube.matrixAutoUpdate = true;
  }
  isAnimating = false;
}

function toggleGridVisibility() {
  if (grid) {
    grid.visible = !grid.visible;
  }
}

function toggleAxisVisibility() {
  if (axes) {
    axes.visible = !axes.visible;
  }
}

function toggleVectorsVisibility() {
  // Implementación para vectores base
  console.log('Toggle vectors visibility');
}

function changeObjectType() {
  // Cambiar entre cubo, esfera, etc.
  console.log('Change object type');
}

function takeScreenshot() {
  if (!renderer) return;
  
  const link = document.createElement('a');
  link.download = 'transformacion-3d.png';
  link.href = renderer.domElement.toDataURL();
  link.click();
}

function toggleFullscreen3D() {
  const container = document.getElementById('threejs-container');
  if (!document.fullscreenElement) {
    container.requestFullscreen().catch(err => {
      console.log(`Error attempting to enable fullscreen: ${err.message}`);
    });
  } else {
    document.exitFullscreen();
  }
}

// Funciones para el modal de accesibilidad
function openModal() {
  document.getElementById('accessibilityModal').classList.add('show');
}

function closeModal() {
  document.getElementById('accessibilityModal').classList.remove('show');
}

// Cerrar modal con ESC
document.addEventListener('keydown', function(event) {
  const modal = document.getElementById('accessibilityModal');
  if (modal && modal.classList.contains('show') && event.key === 'Escape') {
    closeModal();
  }
});

// Navegación con teclado y gestos
document.addEventListener('keydown', function(event) {
  switch(event.key) {
    case 'ArrowRight':
    case ' ':
      nextSlide();
      break;
    case 'ArrowLeft':
      previousSlide();
      break;
    case 'Home':
      goToStart();
      break;
    case 'End':
      goToEnd();
      break;
    case '+':
      zoomIn();
      break;
    case '-':
      zoomOut();
      break;
    case '0':
      resetZoom();
      break;
    case 'f':
    case 'F':
      toggleFullscreen();
      break;
  }
});

// Navegación por gestos en móviles
let touchStartX = 0;
let touchEndX = 0;

document.addEventListener('touchstart', e => {
  touchStartX = e.changedTouches[0].screenX;
});

document.addEventListener('touchend', e => {
  touchEndX = e.changedTouches[0].screenX;
  handleSwipe();
});

function handleSwipe() {
  const swipeThreshold = 50;
  const diff = touchStartX - touchEndX;
  
  if (Math.abs(diff) > swipeThreshold) {
    if (diff > 0) {
      nextSlide();
    } else {
      previousSlide();
    }
  }
}

// Inicialización
document.addEventListener('DOMContentLoaded', function() {
  // Cargar tema guardado
  const savedTheme = localStorage.getItem('theme') || 'dark';
  document.documentElement.setAttribute('data-theme', savedTheme);
  
  // Inicializar componentes
  initializeSearchIndex();
  updateNavigation();
  updateProgress();
  updateMinimap();
  updateUserProgress();
  refreshMath();
  
  // Crear partículas para la portada
  const particlesContainer = document.getElementById('particles');
  if (particlesContainer) {
    for (let i = 0; i < 50; i++) {
      const particle = document.createElement('div');
      particle.classList.add('particle');
      particle.style.left = `${Math.random() * 100}%`;
      particle.style.animationDelay = `${Math.random() * 8}s`;
      particle.style.animationDuration = `${6 + Math.random() * 6}s`;
      particlesContainer.appendChild(particle);
    }
  }
  
  // Inicializar visualización del determinante
  updateDeterminantVisualization();
  
  // Actualizar estadísticas
  updateStatistics();
  
  console.log('Presentación de Álgebra Lineal cargada correctamente');
});
</script>

<!-- Icono de accesibilidad flotante -->
<div class="accessibility-btn" onclick="openModal()" title="Accesibilidad y Privacidad" aria-label="Información de accesibilidad y privacidad">
  ♿
</div>

<!-- Footer institucional -->
<div class="footer">
  <p>
    © 2025 Universidad del SABES · Uso educativo exclusivo · Curso: Álgebra Lineal 2025 · 
    <a href="https://www.sabes.edu.mx" target="_blank">www.sabes.edu.mx</a>
  </p>
</div>

<!-- Modal de Accesibilidad -->
<div class="modal" id="accessibilityModal">
  <div class="modal-content">
    <h2>♿ Accesibilidad WCAG 2.2 AA</h2>
    
    <h3>Características de Accesibilidad</h3>
    <p>Esta presentación cumple con los estándares WCAG 2.2 Nivel AA:</p>
    <ul>
      <li><strong>Navegación por teclado:</strong> Usa las flechas, espacio, teclas numéricas</li>
      <li><strong>Contraste adecuado:</strong> Cumple con relación 4.5:1 mínimo</li>
      <li><strong>Texto redimensionable:</strong> Compatible con zoom hasta 200%</li>
      <li><strong>Estructura semántica:</strong> Encabezados y landmarks apropiados</li>
      <li><strong>Alternativas textuales:</strong> Para contenido no textual</li>
      <li><strong>Animaciones controlables:</strong> Respetan preferencias del sistema</li>
    </ul>
    
    <h3>Atajos de Teclado</h3>
    <ul>
      <li><strong>Flechas:</strong> Navegación entre diapositivas</li>
      <li><strong>Espacio/Enter:</strong> Siguiente diapositiva</li>
      <li><strong>Teclas 1-7:</strong> Ir a diapositiva específica</li>
      <li><strong>F:</strong> Pantalla completa</li>
      <li><strong>+/-:</strong> Zoom in/out</li>
      <li><strong>0:</strong> Resetear zoom</li>
    </ul>
    
    <h3>Compatibilidad</h3>
    <p>Probado con lectores de pantalla: NVDA, JAWS, VoiceOver</p>
    
    <button class="modal-close" onclick="closeModal()">Cerrar</button>
  </div>
</div>

</body>
</html>