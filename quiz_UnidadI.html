<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Universidad del SABES">
  <meta name="copyright" content="¬© 2025 Universidad del SABES. Material educativo interactivo.">
  <meta name="description" content="Quiz interactivo del curso √Ålgebra Lineal - Unidad I: Matrices y Determinantes. Plan de Estudios de Licenciatura 2025, Universidad del SABES. Uso educativo.">
  <meta name="robots" content="noindex, nofollow">
  <meta name="keywords" content="√°lgebra lineal, matrices, determinantes, quiz, educaci√≥n, SABES">
  <title>üéØ Quiz √Ålgebra Lineal - Matrices y Determinantes</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap');
    
    /* ======= VARIABLES CSS ALINEADAS CON UNIDAD 1 ======= */
    :root {
      --base-font: 16px;
      --bg: #1a1f2e;
      --panel: #2a3142ee;
      --ink: #ffffff;
      --muted: #94a3b8;
      --primary: #6496fa;
      --secondary: #00d4aa;
      --accent: #ffd60a;
      --success: #06d6a0;
      --warn: #ffbe0b;
      --danger: #ef476f;
      --steel: #64748b;
      --grad-primary: linear-gradient(135deg, #6496fa 0%, #00d4aa 100%);
    }
    
    [data-theme="light"] {
      --bg: #f8fafc;
      --panel: #ffffff;
      --ink: #1e293b;
      --muted: #475569;
      --primary: #2563eb;
      --secondary: #059669;
      --accent: #d97706;
      --success: #059669;
      --warn: #d97706;
      --danger: #dc2626;
      --steel: #64748b;
    }
    
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
    }
    
    /* ======= FOCO VISIBLE MEJORADO (WCAG 2.4.7 y 2.4.11) ======= */
    *:focus {
      outline: 3px solid var(--primary);
      outline-offset: 2px;
    }

    *:focus:not(:focus-visible) {
      outline: none;
    }

    *:focus-visible {
      outline: 3px solid var(--primary);
      outline-offset: 2px;
      box-shadow: 0 0 0 5px rgba(100, 150, 250, 0.2);
    }

    button:focus-visible,
    a:focus-visible,
    input:focus-visible {
      outline: 3px solid #f57c00;
      outline-offset: 2px;
      box-shadow: 0 0 0 5px rgba(245, 124, 0, 0.2);
    }

    [data-theme="dark"] *:focus-visible {
      outline-color: var(--secondary);
      box-shadow: 0 0 0 5px rgba(0, 212, 170, 0.2);
    }
    
    /* ======= MODO ALTO CONTRASTE (WCAG 2.2) ======= */
    @media (prefers-contrast: high) {
      :root {
        --primary: #0000ff;
        --secondary: #008000;
        --accent: #ff8800;
      }
      
      [data-theme="light"] {
        --ink: #000000;
        --bg: #ffffff;
        --muted: #000000;
      }
      
      [data-theme="dark"] {
        --ink: #ffffff;
        --bg: #000000;
        --muted: #ffffff;
      }
      
      .option, .week-card, .question-header {
        border: 2px solid currentColor !important;
      }
    }
    
    /* ======= RESPETO A PREFERENCIAS DE MOVIMIENTO (WCAG 2.2) ======= */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }
    
    body {
      font-family: 'Inter', sans-serif;
      color: var(--ink);
      background: var(--bg);
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
      font-size: var(--base-font);
      line-height: 1.65;
      transition: all 0.3s ease;
    }
    
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: 
        linear-gradient(90deg, rgba(100, 150, 250, 0.05) 1px, transparent 1px),
        linear-gradient(rgba(0, 212, 170, 0.05) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: matrixFlow 20s linear infinite;
      z-index: 0;
    }
    
    @keyframes matrixFlow {
      from { transform: translate(0, 0); }
      to { transform: translate(50px, 50px); }
    }
    
    .quiz-container {
      position: relative;
      z-index: 2;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .start-screen {
      text-align: center;
      background: linear-gradient(145deg, var(--panel), var(--bg));
      border: 2px solid var(--primary);
      border-radius: 30px;
      padding: 60px 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      animation: slideUp 0.8s ease;
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(50px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .quiz-logo {
      font-size: clamp(3rem, 8vw, 5rem);
      margin-bottom: 20px;
      animation: pulse 2s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .quiz-title {
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 900;
      background: var(--grad-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 15px;
    }
    
    .quiz-subtitle {
      font-size: 1.5rem;
      color: var(--muted);
      margin-bottom: 30px;
      font-weight: 600;
    }
    
    .week-selector {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    
    .week-card {
      background: linear-gradient(145deg, rgba(100, 150, 250, 0.1), rgba(0, 212, 170, 0.1));
      border: 2px solid transparent;
      border-radius: 20px;
      padding: 30px 20px;
      cursor: pointer;
      transition: all 0.4s ease;
    }
    
    .week-card:hover {
      transform: translateY(-10px) scale(1.05);
      border-color: var(--primary);
      box-shadow: 0 20px 40px rgba(100, 150, 250, 0.4);
    }
    
    .week-number {
      font-size: 3rem;
      font-weight: 900;
      color: var(--primary);
    }
    
    .week-name {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--ink);
      margin-top: 10px;
    }
    
    .question-screen {
      display: none;
    }
    
    .question-screen.active {
      display: block;
      animation: questionEnter 0.6s ease;
    }
    
    @keyframes questionEnter {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .question-header {
      background: linear-gradient(145deg, var(--panel), var(--bg));
      border: 2px solid var(--primary);
      border-radius: 25px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 15px 40px rgba(0,0,0,0.3);
    }
    
    .question-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .question-counter {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary);
      background: rgba(100, 150, 250, 0.2);
      padding: 10px 20px;
      border-radius: 20px;
      border: 2px solid var(--primary);
    }
    
    .timer {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2rem;
      font-weight: 900;
      color: var(--accent);
      background: rgba(255, 214, 10, 0.2);
      padding: 15px 30px;
      border-radius: 25px;
      border: 3px solid var(--accent);
      min-width: 120px;
      text-align: center;
    }
    
    .timer.warning {
      color: var(--danger);
      border-color: var(--danger);
      background: rgba(239, 71, 111, 0.2);
      animation: timerWarning 0.5s ease-in-out infinite;
    }
    
    @keyframes timerWarning {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .score-display {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--success);
      background: rgba(6, 214, 160, 0.2);
      padding: 10px 20px;
      border-radius: 20px;
      border: 2px solid var(--success);
    }
    
    .progress-bar {
      width: 100%;
      height: 15px;
      background: rgba(0,0,0,0.3);
      border-radius: 999px;
      overflow: hidden;
      margin-bottom: 20px;
      border: 2px solid rgba(100, 150, 250, 0.3);
    }
    
    .progress-fill {
      height: 100%;
      background: var(--grad-primary);
      width: 0%;
      transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .question-text {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--ink);
      line-height: 1.5;
      margin-bottom: 10px;
    }
    
    /* ======= INSTRUCCIONES DE LA PREGUNTA (NUEVA) ======= */
    .question-instruction {
      font-size: 1.1rem;
      color: var(--muted);
      font-weight: 600;
      margin-bottom: 25px;
      padding: 15px 20px;
      background: rgba(100, 150, 250, 0.1);
      border-left: 4px solid var(--primary);
      border-radius: 8px;
    }
    
    .options-grid {
      display: grid;
      gap: 20px;
      margin-top: 30px;
    }
    
    /* ======= OPCIONES MEJORADAS CON MEJOR LEGIBILIDAD ======= */
    .option {
      background: linear-gradient(145deg, var(--panel), rgba(42, 49, 66, 0.5));
      border: 3px solid rgba(100, 150, 250, 0.3);
      border-radius: 20px;
      padding: 25px 30px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      gap: 20px;
      position: relative;
      overflow: hidden;
    }
    
    .option::before {
      content: '';
      position: absolute;
      inset: 0;
      background: var(--grad-primary);
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    
    .option:hover {
      transform: translateX(10px) scale(1.02);
      border-color: var(--primary);
      box-shadow: 0 10px 30px rgba(100, 150, 250, 0.3);
    }
    
    .option:hover::before {
      opacity: 0.1;
    }
    
    /* ======= LETRA DE OPCI√ìN M√ÅS LEGIBLE ======= */
    .option-letter {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2rem;
      font-weight: 900;
      color: var(--primary);
      background: rgba(100, 150, 250, 0.2);
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      border: 3px solid var(--primary);
      position: relative;
      z-index: 1;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    /* ======= TEXTO DE OPCI√ìN M√ÅS LEGIBLE ======= */
    .option-text {
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--ink);
      flex: 1;
      position: relative;
      z-index: 1;
      line-height: 1.6;
      /* Mejor contraste para legibilidad */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }
    
    /* Estados de las opciones */
    .option.selected {
      border-color: var(--primary);
      background: linear-gradient(145deg, rgba(100, 150, 250, 0.2), rgba(0, 212, 170, 0.1));
    }
    
    .option.selected::before {
      opacity: 0.2;
    }
    
    .option.selected .option-letter {
      background: var(--primary);
      color: white;
      transform: scale(1.1);
    }
    
    .option.correct {
      border-color: var(--success);
      background: linear-gradient(145deg, rgba(6, 214, 160, 0.2), rgba(6, 214, 160, 0.1));
      animation: correctPulse 0.6s ease;
    }
    
    .option.correct .option-letter {
      background: var(--success);
      color: white;
      border-color: var(--success);
    }
    
    .option.incorrect {
      border-color: var(--danger);
      background: linear-gradient(145deg, rgba(239, 71, 111, 0.2), rgba(239, 71, 111, 0.1));
      animation: shake 0.5s ease;
    }
    
    .option.incorrect .option-letter {
      background: var(--danger);
      color: white;
      border-color: var(--danger);
    }
    
    @keyframes correctPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    
    .feedback {
      margin-top: 30px;
      padding: 25px;
      border-radius: 20px;
      font-size: 1.2rem;
      font-weight: 600;
      display: none;
      animation: feedbackSlide 0.5s ease;
      line-height: 1.6;
    }
    
    @keyframes feedbackSlide {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .feedback.correct {
      background: linear-gradient(145deg, rgba(6, 214, 160, 0.2), rgba(6, 214, 160, 0.1));
      border: 2px solid var(--success);
      color: var(--success);
    }
    
    .feedback.incorrect {
      background: linear-gradient(145deg, rgba(239, 71, 111, 0.2), rgba(239, 71, 111, 0.1));
      border: 2px solid var(--danger);
      color: var(--danger);
    }
    
    .btn {
      font-family: 'Inter', sans-serif;
      font-size: 1.2rem;
      font-weight: 700;
      padding: 18px 40px;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
    }
    
    .btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: white;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    
    .btn:hover::before {
      opacity: 0.1;
    }
    
    .btn:active {
      transform: scale(0.95);
    }
    
    .btn-primary {
      background: var(--grad-primary);
      color: white;
      box-shadow: 0 10px 30px rgba(100, 150, 250, 0.4);
    }
    
    .btn-primary:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(100, 150, 250, 0.5);
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, var(--steel) 0%, var(--muted) 100%);
      color: white;
      box-shadow: 0 10px 30px rgba(100, 116, 139, 0.4);
    }
    
    .btn-secondary:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(100, 116, 139, 0.5);
    }
    
    .question-actions {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 40px;
      flex-wrap: wrap;
    }
    
    .results-screen {
      display: none;
      text-align: center;
    }
    
    .results-screen.active {
      display: block;
      animation: slideUp 0.8s ease;
    }
    
    .results-card {
      background: linear-gradient(145deg, var(--panel), var(--bg));
      border: 2px solid var(--primary);
      border-radius: 30px;
      padding: 50px 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .trophy {
      font-size: 6rem;
      margin-bottom: 20px;
      animation: pulse 2s ease-in-out infinite;
    }
    
    .results-title {
      font-size: 2.5rem;
      font-weight: 900;
      background: var(--grad-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 20px;
    }
    
    .results-message {
      font-size: 1.5rem;
      color: var(--muted);
      margin-bottom: 40px;
      font-weight: 600;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 40px 0;
    }
    
    .stat-card {
      background: linear-gradient(145deg, rgba(100, 150, 250, 0.1), rgba(0, 212, 170, 0.1));
      border: 2px solid var(--primary);
      border-radius: 20px;
      padding: 25px;
    }
    
    .stat-label {
      font-size: 1rem;
      color: var(--muted);
      margin-bottom: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .stat-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--primary);
    }
    
    .personal-feedback {
      background: rgba(100, 150, 250, 0.1);
      border-left: 4px solid var(--primary);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      text-align: left;
    }
    
    .personal-feedback h4 {
      color: var(--primary);
      margin-bottom: 15px;
      font-size: 1.3rem;
    }
    
    .personal-feedback p {
      color: var(--ink);
      margin: 10px 0;
      font-size: 1.1rem;
      line-height: 1.6;
    }
    
    .results-actions {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 40px;
    }
    
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 3px solid var(--primary);
      background: var(--panel);
      color: var(--primary);
      font-size: 1.8rem;
      cursor: pointer;
      transition: all 0.4s ease;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    }
    
    .theme-toggle:hover {
      transform: rotate(360deg) scale(1.1);
      box-shadow: 0 10px 30px rgba(100, 150, 250, 0.4);
    }
    
    .hidden {
      display: none !important;
    }
    
    .confetti-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 9999;
    }
    
    .confetti-piece {
      position: absolute;
      width: 10px;
      height: 10px;
      top: -10px;
      animation: confettiFall 3s linear forwards;
    }
    
    @keyframes confettiFall {
      to {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }
    
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      backdrop-filter: blur(10px);
    }
    
    .modal.show {
      display: flex;
    }
    
    .modal-content {
      background: var(--panel);
      border: 2px solid var(--primary);
      border-radius: 25px;
      padding: 40px;
      max-width: 600px;
      width: 100%;
      max-height: 80vh;
      overflow-y: auto;
      animation: modalEnter 0.4s ease;
    }
    
    @keyframes modalEnter {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .modal-header {
      font-size: 2rem;
      font-weight: 900;
      color: var(--primary);
      margin-bottom: 20px;
    }
    
    .modal-body {
      color: var(--ink);
      font-size: 1.1rem;
      line-height: 1.8;
    }
    
    .modal-body p {
      margin-bottom: 15px;
    }
    
    .modal-close {
      margin-top: 30px;
      width: 100%;
    }
    
    .credits-screen {
      display: none;
      text-align: center;
    }
    
    .credits-screen.active {
      display: block;
      animation: slideUp 0.8s ease;
    }
    
    .credits-card {
      background: linear-gradient(145deg, var(--panel), var(--bg));
      border: 2px solid var(--primary);
      border-radius: 30px;
      padding: 50px 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      max-width: 800px;
      margin: 0 auto;
    }
    
    .credits-title {
      font-size: 2.5rem;
      font-weight: 900;
      background: var(--grad-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 30px;
    }
    
    .credits-content {
      color: var(--ink);
      font-size: 1.2rem;
      line-height: 1.8;
      margin-bottom: 30px;
    }
    
    .credits-content p {
      margin-bottom: 15px;
    }
    
    .credits-content strong {
      color: var(--primary);
    }
    
    @media (max-width: 768px) {
      .quiz-container {
        padding: 15px;
      }
      
      .start-screen, .results-card, .credits-card {
        padding: 30px 20px;
      }
      
      .quiz-title {
        font-size: 2rem;
      }
      
      .quiz-subtitle {
        font-size: 1.2rem;
      }
      
      .question-text {
        font-size: 1.4rem;
      }
      
      .option {
        padding: 20px;
      }
      
      .option-letter {
        width: 50px;
        height: 50px;
        font-size: 1.5rem;
      }
      
      .option-text {
        font-size: 1.1rem;
      }
      
      .btn {
        font-size: 1rem;
        padding: 15px 30px;
      }
      
      .question-info {
        flex-direction: column;
      }
      
      .timer {
        font-size: 1.5rem;
        padding: 10px 20px;
      }
      
      .theme-toggle {
        width: 50px;
        height: 50px;
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()" aria-label="Cambiar tema">üåì</button>
  
  <div class="quiz-container">
    <!-- Pantalla de inicio -->
    <div id="startScreen" class="start-screen">
      <div class="quiz-logo">üéØ</div>
      <h1 class="quiz-title">Quiz √Ålgebra Lineal</h1>
      <p class="quiz-subtitle">Unidad I: Matrices y Determinantes</p>
      
      <div class="week-selector">
        <div class="week-card" onclick="startQuiz(1)" tabindex="0" role="button" aria-label="Iniciar quiz Semana 1">
          <div class="week-number">1Ô∏è‚É£</div>
          <div class="week-name">Semana 1</div>
          <p style="color: var(--muted); margin-top: 10px; font-size: 0.9rem;">Definiciones b√°sicas</p>
        </div>
        
        <div class="week-card" onclick="startQuiz(2)" tabindex="0" role="button" aria-label="Iniciar quiz Semana 2">
          <div class="week-number">2Ô∏è‚É£</div>
          <div class="week-name">Semana 2</div>
          <p style="color: var(--muted); margin-top: 10px; font-size: 0.9rem;">Operaciones matriciales</p>
        </div>
        
        <div class="week-card" onclick="startQuiz(3)" tabindex="0" role="button" aria-label="Iniciar quiz Semana 3">
          <div class="week-number">3Ô∏è‚É£</div>
          <div class="week-name">Semana 3</div>
          <p style="color: var(--muted); margin-top: 10px; font-size: 0.9rem;">Inversas y sistemas</p>
        </div>
        
        <div class="week-card" onclick="startQuiz(4)" tabindex="0" role="button" aria-label="Iniciar quiz Semana 4">
          <div class="week-number">4Ô∏è‚É£</div>
          <div class="week-name">Semana 4</div>
          <p style="color: var(--muted); margin-top: 10px; font-size: 0.9rem;">Determinantes</p>
        </div>
      </div>
      
      <div style="margin-top: 40px; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
        <button class="btn btn-secondary" onclick="openModal()">‚ÑπÔ∏è Informaci√≥n</button>
        <button class="btn btn-secondary" onclick="showCredits()">üë• Cr√©ditos</button>
      </div>
    </div>
    
    <!-- Pantalla de preguntas -->
    <div id="questionScreen" class="question-screen">
      <div class="question-header">
        <div class="question-info">
          <div class="question-counter" id="questionCounter">Pregunta 1/10</div>
          <div class="timer" id="timer">30</div>
          <div class="score-display" id="scoreDisplay">0 pts</div>
        </div>
        
        <div class="progress-bar">
          <div class="progress-fill" id="progressBar"></div>
        </div>
        
        <h2 class="question-text" id="questionText"></h2>
        
        <!-- INSTRUCCI√ìN AGREGADA AQU√ç -->
        <div class="question-instruction">
          üìå Selecciona una de las siguientes opciones:
        </div>
      </div>
      
      <div class="options-grid" id="optionsGrid"></div>
      
      <div class="feedback" id="feedback"></div>
      
      <div class="question-actions">
        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">
          Siguiente Pregunta ‚Üí
        </button>
      </div>
    </div>
    
    <!-- Pantalla de resultados -->
    <div id="resultsScreen" class="results-screen">
      <div class="results-card">
        <div class="trophy" id="trophyEmoji">üèÜ</div>
        <h2 class="results-title">¬°Quiz Completado!</h2>
        <p class="results-message" id="resultsMessage"></p>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">Puntuaci√≥n Final</div>
            <div class="stat-value" id="finalScore">0 pts</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-label">Respuestas Correctas</div>
            <div class="stat-value" id="correctCount">0/10</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-label">Precisi√≥n</div>
            <div class="stat-value" id="accuracyPercent">0%</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-label">Tiempo Promedio</div>
            <div class="stat-value" id="timeAverage">0s</div>
          </div>
        </div>
        
        <div class="personal-feedback" id="personalFeedback"></div>
        
        <div class="results-actions">
          <button class="btn btn-primary" onclick="restartQuiz()">üîÑ Nuevo Quiz</button>
          <button class="btn btn-secondary" onclick="reviewAnswers()">üìä Revisar Respuestas</button>
          <button class="btn btn-secondary" onclick="shareResults()">üì§ Compartir</button>
        </div>
      </div>
    </div>
    
    <!-- Pantalla de cr√©ditos -->
    <div id="creditsScreen" class="credits-screen">
      <div class="credits-card">
        <h2 class="credits-title">üë• Cr√©ditos</h2>
        <div class="credits-content">
          <p><strong>üéì Universidad del SABES</strong></p>
          <p><strong>üìö Curso:</strong> √Ålgebra Lineal</p>
          <p><strong>üìñ Unidad I:</strong> Matrices y Determinantes</p>
          <p><strong>üë®‚Äçüè´ Material did√°ctico interactivo</strong></p>
          <p>Dise√±ado para facilitar el aprendizaje y evaluaci√≥n de conceptos fundamentales del √°lgebra lineal</p>
          <p style="margin-top: 30px; color: var(--muted); font-size: 1rem;">
            ¬© 2025 Universidad del SABES<br>
            Todos los derechos reservados<br>
            Uso exclusivo con fines educativos
          </p>
        </div>
        <button class="btn btn-primary" onclick="closeCredits()">‚Üê Volver</button>
      </div>
    </div>
  </div>
  
  <!-- Modal de informaci√≥n -->
  <div id="privacyModal" class="modal">
    <div class="modal-content">
      <h3 class="modal-header">‚ÑπÔ∏è Informaci√≥n del Quiz</h3>
      <div class="modal-body">
        <p><strong>üìã Formato:</strong> 10 preguntas aleatorias por semana</p>
        <p><strong>‚è±Ô∏è Tiempo:</strong> 30 segundos por pregunta</p>
        <p><strong>üéØ Puntuaci√≥n:</strong></p>
        <ul style="margin-left: 20px; margin-bottom: 15px;">
          <li>Respuesta r√°pida (0-10s): 15 puntos</li>
          <li>Respuesta media (11-20s): 10 puntos</li>
          <li>Respuesta lenta (21-30s): 5 puntos</li>
          <li>Sin respuesta: 0 puntos</li>
        </ul>
        <p><strong>‚å®Ô∏è Atajos de teclado:</strong></p>
        <ul style="margin-left: 20px; margin-bottom: 15px;">
          <li>Teclas 1-4: Seleccionar opci√≥n</li>
          <li>Enter: Siguiente pregunta</li>
          <li>Escape: Cerrar modal</li>
        </ul>
        <p><strong>‚ôø Accesibilidad:</strong> Este quiz cumple con los est√°ndares WCAG 2.2 AA</p>
        <p><strong>üîí Privacidad:</strong> Tus respuestas no se guardan ni se comparten</p>
      </div>
      <button class="btn btn-primary modal-close" onclick="closeModal()">Entendido</button>
    </div>
  </div>
  
  <div id="confetti" class="confetti-container"></div>
  
  <script>
    const questionsByWeek = {
      1: [
        {
          question: "¬øCu√°l es el orden de la matriz A = [[1, 2, 3], [4, 5, 6]]?",
          options: ["2√ó3", "3√ó2", "2√ó2", "3√ó3"],
          correct: 0,
          explanation: "El orden de una matriz se expresa como filas √ó columnas. Esta matriz tiene 2 filas y 3 columnas, por lo tanto su orden es 2√ó3."
        },
        {
          question: "Una matriz cuadrada es aquella donde:",
          options: ["El n√∫mero de filas es igual al n√∫mero de columnas", "Todos los elementos son iguales", "La diagonal principal son ceros", "Tiene solo dos filas"],
          correct: 0,
          explanation: "Una matriz cuadrada es aquella que tiene el mismo n√∫mero de filas que de columnas, como una matriz 3√ó3 o 5√ó5."
        },
        {
          question: "¬øQu√© caracteriza a una matriz diagonal?",
          options: ["Todos los elementos fuera de la diagonal principal son cero", "Todos los elementos son iguales", "Solo tiene dos columnas", "La diagonal principal es cero"],
          correct: 0,
          explanation: "Una matriz diagonal tiene todos sus elementos fuera de la diagonal principal iguales a cero. Los elementos de la diagonal pueden ser cualquier valor."
        },
        {
          question: "Una matriz identidad de orden 3 tiene:",
          options: ["Unos en la diagonal principal y ceros en el resto", "Todos los elementos iguales a 1", "Tres filas y dos columnas", "Ceros en la diagonal principal"],
          correct: 0,
          explanation: "La matriz identidad tiene unos (1) en su diagonal principal y ceros (0) en todos los dem√°s elementos."
        },
        {
          question: "¬øCu√°l es la traspuesta de la matriz [[1, 2], [3, 4]]?",
          options: ["[[1, 3], [2, 4]]", "[[4, 3], [2, 1]]", "[[2, 1], [4, 3]]", "[[1, 2], [3, 4]]"],
          correct: 0,
          explanation: "La traspuesta de una matriz se obtiene intercambiando filas por columnas. As√≠, la primera fila [1, 2] se convierte en la primera columna."
        },
        {
          question: "Una matriz sim√©trica cumple que:",
          options: ["A = A·µÄ (es igual a su traspuesta)", "Todos sus elementos son iguales", "Es una matriz cuadrada con diagonal cero", "Tiene orden 2√ó2"],
          correct: 0,
          explanation: "Una matriz es sim√©trica cuando es igual a su traspuesta, es decir, A = A·µÄ. Esto implica que los elementos reflejados respecto a la diagonal son iguales."
        },
        {
          question: "¬øQu√© es una matriz nula?",
          options: ["Una matriz donde todos los elementos son cero", "Una matriz sin filas", "Una matriz con determinante cero", "Una matriz 1√ó1"],
          correct: 0,
          explanation: "Una matriz nula o matriz cero es aquella donde todos sus elementos son iguales a cero, independientemente de su orden."
        },
        {
          question: "En una matriz triangular superior:",
          options: ["Todos los elementos debajo de la diagonal principal son cero", "Todos los elementos arriba de la diagonal son cero", "La diagonal principal es cero", "Todos los elementos son iguales"],
          correct: 0,
          explanation: "Una matriz triangular superior tiene todos los elementos por debajo de la diagonal principal iguales a cero."
        },
        {
          question: "¬øCu√°l es el elemento a‚ÇÇ‚ÇÉ en una matriz A?",
          options: ["Elemento en la fila 2, columna 3", "Elemento en la fila 3, columna 2", "Elemento en posici√≥n (2,2)", "Elemento en posici√≥n (3,3)"],
          correct: 0,
          explanation: "La notaci√≥n a·µ¢‚±º indica el elemento en la fila i y columna j. Por lo tanto, a‚ÇÇ‚ÇÉ es el elemento en la fila 2, columna 3."
        },
        {
          question: "Dos matrices se pueden sumar si:",
          options: ["Tienen el mismo orden", "Son matrices cuadradas", "Tienen el mismo determinante", "Son matrices sim√©tricas"],
          correct: 0,
          explanation: "Para sumar dos matrices, ambas deben tener exactamente el mismo orden (mismo n√∫mero de filas y columnas)."
        },
        {
          question: "Una matriz escalar es:",
          options: ["Una matriz diagonal con todos los elementos de la diagonal iguales", "Una matriz con un solo elemento", "Una matriz 1√ó1", "Una matriz multiplicada por un escalar"],
          correct: 0,
          explanation: "Una matriz escalar es una matriz diagonal donde todos los elementos de la diagonal principal son iguales entre s√≠."
        },
        {
          question: "¬øQu√© propiedad NO cumple la suma de matrices?",
          options: ["Divisi√≥n", "Conmutativa", "Asociativa", "Elemento neutro"],
          correct: 0,
          explanation: "La divisi√≥n no est√° definida como operaci√≥n entre matrices. Las matrices s√≠ cumplen las propiedades conmutativa, asociativa y tienen elemento neutro."
        }
      ],
      2: [
        {
          question: "¬øCu√°l operaci√≥n NO cambia el determinante?",
          options: ["Sumar a una fila un m√∫ltiplo de otra", "Multiplicar una fila por un escalar", "Intercambiar dos filas", "Multiplicar la matriz por un escalar"],
          correct: 0,
          explanation: "Sumar a una fila un m√∫ltiplo de otra fila no cambia el valor del determinante. Esta es una operaci√≥n fundamental en el m√©todo de Gauss."
        },
        {
          question: "Para multiplicar dos matrices A y B, se requiere que:",
          options: ["El n√∫mero de columnas de A sea igual al n√∫mero de filas de B", "Ambas sean matrices cuadradas", "Tengan el mismo orden", "Sean matrices sim√©tricas"],
          correct: 0,
          explanation: "Para que el producto AB est√© definido, el n√∫mero de columnas de A debe ser igual al n√∫mero de filas de B."
        },
        {
          question: "La multiplicaci√≥n de matrices es:",
          options: ["Asociativa pero no conmutativa", "Conmutativa pero no asociativa", "Conmutativa y asociativa", "Ni conmutativa ni asociativa"],
          correct: 0,
          explanation: "La multiplicaci√≥n de matrices es asociativa (A(BC) = (AB)C) pero NO es conmutativa (AB ‚â† BA en general)."
        },
        {
          question: "Si A es una matriz 3√ó2 y B es 2√ó4, entonces AB es:",
          options: ["3√ó4", "2√ó2", "3√ó2", "No se puede multiplicar"],
          correct: 0,
          explanation: "El producto de una matriz m√ón por una matriz n√óp resulta en una matriz m√óp. Por lo tanto, 3√ó2 por 2√ó4 da 3√ó4."
        },
        {
          question: "¬øQu√© resultado da I¬∑A donde I es la identidad?",
          options: ["A", "I", "0", "A·µÄ"],
          correct: 0,
          explanation: "La matriz identidad es el elemento neutro de la multiplicaci√≥n. Por lo tanto, I¬∑A = A¬∑I = A."
        },
        {
          question: "Al multiplicar una matriz por un escalar k:",
          options: ["Cada elemento se multiplica por k", "Solo la diagonal se multiplica por k", "El determinante no cambia", "La matriz se hace invertible"],
          correct: 0,
          explanation: "Al multiplicar una matriz por un escalar k, cada uno de sus elementos se multiplica por ese escalar."
        },
        {
          question: "La propiedad distributiva en matrices establece:",
          options: ["A(B + C) = AB + AC", "AB = BA", "(AB)·µÄ = A·µÄB·µÄ", "A + BC = (A + B)(A + C)"],
          correct: 0,
          explanation: "La multiplicaci√≥n de matrices distribuye sobre la suma: A(B + C) = AB + AC."
        },
        {
          question: "Si (AB)·µÄ = B·µÄA·µÄ, entonces:",
          options: ["Se invierte el orden de los factores al trasponerlos", "A = B", "AB = BA", "A y B son sim√©tricas"],
          correct: 0,
          explanation: "Al trasponer un producto de matrices, se invierte el orden de los factores: (AB)·µÄ = B·µÄA·µÄ."
        },
        {
          question: "Una matriz A es idempotente si:",
          options: ["A¬≤ = A", "A¬≤ = I", "A¬≤ = 0", "A·µÄ = A"],
          correct: 0,
          explanation: "Una matriz es idempotente cuando al multiplicarla por s√≠ misma se obtiene la misma matriz: A¬≤ = A."
        },
        {
          question: "El elemento (i,j) del producto AB se calcula como:",
          options: ["La suma de productos de elementos de la fila i de A por elementos de la columna j de B", "El producto de a·µ¢‚±º por b·µ¢‚±º", "La suma de a·µ¢‚±º y b·µ¢‚±º", "El producto de la fila i por la fila j"],
          correct: 0,
          explanation: "El elemento (i,j) de AB es la suma de los productos de los elementos de la fila i de A por los elementos correspondientes de la columna j de B."
        },
        {
          question: "Si A es 2√ó3 y B es 3√ó2, entonces:",
          options: ["AB y BA tienen √≥rdenes diferentes", "AB = BA", "Ning√∫n producto est√° definido", "AB y BA son iguales"],
          correct: 0,
          explanation: "AB ser√° una matriz 2√ó2 y BA ser√° una matriz 3√ó3, por lo que tienen √≥rdenes diferentes y no pueden ser iguales."
        },
        {
          question: "¬øCu√°l es la traza de una matriz?",
          options: ["La suma de los elementos de la diagonal principal", "El determinante", "El producto de la diagonal", "La suma de todos los elementos"],
          correct: 0,
          explanation: "La traza (tr(A)) de una matriz es la suma de todos los elementos en su diagonal principal."
        }
      ],
      3: [
        {
          question: "Una matriz A es invertible si:",
          options: ["det(A) ‚â† 0", "det(A) = 0", "Es una matriz diagonal", "Es una matriz sim√©trica"],
          correct: 0,
          explanation: "Una matriz es invertible (no singular) si y solo si su determinante es diferente de cero."
        },
        {
          question: "La matriz inversa A‚Åª¬π cumple que:",
          options: ["AA‚Åª¬π = A‚Åª¬πA = I", "AA‚Åª¬π = 0", "AA‚Åª¬π = A", "A‚Åª¬π = A·µÄ"],
          correct: 0,
          explanation: "La matriz inversa cumple que al multiplicarla por la matriz original (en cualquier orden) da la matriz identidad."
        },
        {
          question: "El m√©todo de Gauss-Jordan se usa para:",
          options: ["Encontrar la matriz inversa y resolver sistemas", "Calcular determinantes √∫nicamente", "Multiplicar matrices", "Sumar matrices"],
          correct: 0,
          explanation: "El m√©todo de Gauss-Jordan se utiliza para encontrar matrices inversas y resolver sistemas de ecuaciones lineales."
        },
        {
          question: "En el m√©todo de Gauss-Jordan, la matriz aumentada [A|I] se transforma en:",
          options: ["[I|A‚Åª¬π]", "[A‚Åª¬π|I]", "[A|A‚Åª¬π]", "[I|A]"],
          correct: 0,
          explanation: "Al aplicar Gauss-Jordan a [A|I], si A es invertible, se obtiene [I|A‚Åª¬π], donde A‚Åª¬π es la inversa de A."
        },
        {
          question: "Si det(A) = 0, entonces A es:",
          options: ["Singular (no invertible)", "Invertible", "La matriz identidad", "Una matriz diagonal"],
          correct: 0,
          explanation: "Una matriz con determinante cero es singular, lo que significa que no tiene inversa."
        },
        {
          question: "¬øCu√°l es la inversa de la matriz identidad I?",
          options: ["I", "0", "No existe", "-I"],
          correct: 0,
          explanation: "La matriz identidad es su propia inversa, ya que I¬∑I = I."
        },
        {
          question: "Si A y B son invertibles, entonces (AB)‚Åª¬π es:",
          options: ["B‚Åª¬πA‚Åª¬π", "A‚Åª¬πB‚Åª¬π", "AB", "(BA)‚Åª¬π"],
          correct: 0,
          explanation: "La inversa de un producto se calcula invirtiendo el orden: (AB)‚Åª¬π = B‚Åª¬πA‚Åª¬π."
        },
        {
          question: "Una operaci√≥n elemental por filas:",
          options: ["Puede revertirse con otra operaci√≥n elemental", "Cambia siempre el determinante", "No se puede deshacer", "Solo se aplica a matrices cuadradas"],
          correct: 0,
          explanation: "Toda operaci√≥n elemental por filas tiene una operaci√≥n inversa que la deshace."
        },
        {
          question: "El rango de una matriz A es:",
          options: ["El n√∫mero m√°ximo de filas linealmente independientes", "El determinante de A", "El n√∫mero de columnas", "El n√∫mero de filas"],
          correct: 0,
          explanation: "El rango es el n√∫mero m√°ximo de filas (o columnas) linealmente independientes en la matriz."
        },
        {
          question: "Un sistema de ecuaciones Ax = b tiene soluci√≥n √∫nica si:",
          options: ["A es invertible", "det(A) = 0", "A no es cuadrada", "b = 0"],
          correct: 0,
          explanation: "Un sistema Ax = b tiene soluci√≥n √∫nica cuando A es invertible (det(A) ‚â† 0), y la soluci√≥n es x = A‚Åª¬πb."
        },
        {
          question: "¬øQu√© matriz NO es invertible?",
          options: ["[[1, 2], [2, 4]]", "[[1, 0], [0, 1]]", "[[2, 1], [1, 2]]", "[[1, 2], [3, 4]]"],
          correct: 0,
          explanation: "La matriz [[1, 2], [2, 4]] tiene determinante 0 (la segunda fila es el doble de la primera), por lo que no es invertible."
        },
        {
          question: "Si A¬≤ = I, entonces A‚Åª¬π es:",
          options: ["A", "I", "A¬≤", "-A"],
          correct: 0,
          explanation: "Si A¬≤ = I, entonces A¬∑A = I, lo que significa que A es su propia inversa: A‚Åª¬π = A."
        }
      ],
      4: [
        {
          question: "El determinante de una matriz 2√ó2 [[a,b],[c,d]] es:",
          options: ["ad - bc", "ab - cd", "ac - bd", "a + b + c + d"],
          correct: 0,
          explanation: "Para una matriz 2√ó2, el determinante se calcula como ad - bc (producto de la diagonal principal menos producto de la diagonal secundaria)."
        },
        {
          question: "Si se intercambian dos filas de una matriz, su determinante:",
          options: ["Cambia de signo", "Se duplica", "No cambia", "Se hace cero"],
          correct: 0,
          explanation: "Intercambiar dos filas (o dos columnas) de una matriz cambia el signo del determinante."
        },
        {
          question: "Si una fila es m√∫ltiplo de otra, el determinante es:",
          options: ["0", "1", "El valor del m√∫ltiplo", "Infinito"],
          correct: 0,
          explanation: "Si una fila (o columna) es m√∫ltiplo de otra, significa que las filas son linealmente dependientes y el determinante es cero."
        },
        {
          question: "¬øCu√°l operaci√≥n NO cambia el determinante?",
          options: ["Sumar a una fila un m√∫ltiplo de otra", "Multiplicar una fila por un escalar", "Intercambiar dos filas", "Multiplicar la matriz por un escalar"],
          correct: 0,
          explanation: "Sumar a una fila un m√∫ltiplo de otra fila no altera el valor del determinante."
        },
        {
          question: "El determinante de la matriz identidad es:",
          options: ["1", "0", "El orden de la matriz", "Infinito"],
          correct: 0,
          explanation: "El determinante de cualquier matriz identidad I es siempre igual a 1."
        },
        {
          question: "Si det(A) = 5 y det(B) = 3, entonces det(AB) es:",
          options: ["15", "8", "2", "5/3"],
          correct: 0,
          explanation: "El determinante de un producto es el producto de los determinantes: det(AB) = det(A)¬∑det(B) = 5¬∑3 = 15."
        },
        {
          question: "El determinante de una matriz triangular es:",
          options: ["El producto de los elementos de la diagonal principal", "La suma de la diagonal", "Siempre cero", "Siempre uno"],
          correct: 0,
          explanation: "Para matrices triangulares (superiores o inferiores), el determinante es el producto de todos los elementos de la diagonal principal."
        },
        {
          question: "Si det(A) = k, entonces det(cA) es (donde c es un escalar y A es n√ón):",
          options: ["c‚Åøk", "ck", "k", "c + k"],
          correct: 0,
          explanation: "Al multiplicar una matriz n√ón por un escalar c, su determinante se multiplica por c‚Åø. Por lo tanto, det(cA) = c‚Åø¬∑det(A)."
        },
        {
          question: "El cofactor C·µ¢‚±º de un elemento a·µ¢‚±º se calcula como:",
          options: ["(-1)^(i+j) √ó M·µ¢‚±º", "a·µ¢‚±º √ó M·µ¢‚±º", "M·µ¢‚±º / a·µ¢‚±º", "(-1)^(ij) √ó a·µ¢‚±º"],
          correct: 0,
          explanation: "El cofactor C·µ¢‚±º se obtiene multiplicando (-1)^(i+j) por el menor M·µ¢‚±º correspondiente al elemento a·µ¢‚±º."
        },
        {
          question: "La regla de Cramer se usa para:",
          options: ["Resolver sistemas de ecuaciones lineales", "Calcular matrices inversas", "Multiplicar matrices", "Hallar eigenvectores"],
          correct: 0,
          explanation: "La regla de Cramer es un m√©todo para resolver sistemas de ecuaciones lineales usando determinantes."
        },
        {
          question: "Si det(A) ‚â† 0, entonces:",
          options: ["A es invertible", "A no es invertible", "A = I", "A = 0"],
          correct: 0,
          explanation: "Una matriz es invertible si y solo si su determinante es diferente de cero."
        },
        {
          question: "El determinante de A·µÄ (A traspuesta) es:",
          options: ["Igual a det(A)", "Negativo de det(A)", "El inverso de det(A)", "Cero"],
          correct: 0,
          explanation: "El determinante de una matriz y el de su traspuesta son iguales: det(A·µÄ) = det(A)."
        },
        {
          question: "Si una matriz tiene una fila de ceros, su determinante es:",
          options: ["0", "1", "Indefinido", "Igual a las otras filas"],
          correct: 0,
          explanation: "Si una matriz tiene una fila (o columna) completamente de ceros, su determinante es siempre cero."
        },
        {
          question: "Para una matriz 3√ó3, ¬øcu√°ntos t√©rminos tiene su desarrollo por cofactores?",
          options: ["6", "3", "9", "12"],
          correct: 0,
          explanation: "El desarrollo del determinante de una matriz 3√ó3 tiene 6 t√©rminos (3! = 6 permutaciones)."
        }
      ]
    };
    
    let currentWeek = 0;
    let questionPool = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let selectedAnswer = -1;
    let timeLeft = 30;
    let timer;
    let userAnswers = [];
    let totalTime = 0;
    
    function startQuiz(week) {
      currentWeek = week;
      
      // Seleccionar 10 preguntas aleatorias de la semana
      const allQuestions = questionsByWeek[week];
      questionPool = shuffleArray(allQuestions).slice(0, 10);
      
      currentQuestionIndex = 0;
      score = 0;
      userAnswers = [];
      totalTime = 0;
      
      document.getElementById('startScreen').classList.add('hidden');
      document.getElementById('questionScreen').classList.add('active');
      
      loadQuestion();
    }
    
    function loadQuestion() {
      if (currentQuestionIndex >= questionPool.length) {
        showResults();
        return;
      }
      
      selectedAnswer = -1;
      timeLeft = 30;
      
      const question = questionPool[currentQuestionIndex];
      
      document.getElementById('questionCounter').textContent = 
        `Pregunta ${currentQuestionIndex + 1}/10`;
      document.getElementById('questionText').textContent = question.question;
      document.getElementById('scoreDisplay').textContent = score + ' pts';
      document.getElementById('nextBtn').style.display = 'none';
      document.getElementById('feedback').style.display = 'none';
      
      const progress = ((currentQuestionIndex + 1) / questionPool.length) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      
      const optionsGrid = document.getElementById('optionsGrid');
      optionsGrid.innerHTML = '';
      
      // Mezclar las opciones aleatoriamente
      const shuffledOptions = question.options.map((option, index) => ({
        text: option,
        originalIndex: index
      }));
      
      // Barajar el array de opciones
      for (let i = shuffledOptions.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffledOptions[i], shuffledOptions[j]] = [shuffledOptions[j], shuffledOptions[i]];
      }
      
      // Encontrar la nueva posici√≥n de la respuesta correcta
      const newCorrectIndex = shuffledOptions.findIndex(opt => opt.originalIndex === question.correct);
      
      // Guardar el nuevo √≠ndice correcto y las opciones mezcladas en la pregunta
      question.shuffledCorrect = newCorrectIndex;
      question.shuffledOptions = shuffledOptions;
      
      const letters = ['A', 'B', 'C', 'D'];
      shuffledOptions.forEach((option, index) => {
        const optionDiv = document.createElement('div');
        optionDiv.className = 'option';
        optionDiv.onclick = () => selectOption(index);
        optionDiv.tabIndex = 0;
        optionDiv.setAttribute('role', 'button');
        optionDiv.setAttribute('aria-label', `Opci√≥n ${letters[index]}: ${option.text}`);
        
        optionDiv.innerHTML = `
          <div class="option-letter">${letters[index]}</div>
          <div class="option-text">${option.text}</div>
        `;
        
        optionsGrid.appendChild(optionDiv);
      });
      
      startTimer();
    }
    
    function selectOption(index) {
      if (selectedAnswer !== -1) return;
      
      clearInterval(timer);
      selectedAnswer = index;
      
      const question = questionPool[currentQuestionIndex];
      const options = document.querySelectorAll('.option');
      const timeTaken = 30 - timeLeft;
      
      options.forEach(opt => opt.onclick = null);
      
      options[index].classList.add('selected');
      
      let points = 0;
      let isCorrect = index === question.shuffledCorrect;
      
      // Obtener los textos de las respuestas desde las opciones mezcladas
      const selectedAnswerText = question.shuffledOptions[index].text;
      const correctAnswerText = question.shuffledOptions[question.shuffledCorrect].text;
      
      if (isCorrect) {
        if (timeTaken <= 10) points = 15;
        else if (timeTaken <= 20) points = 10;
        else points = 5;
        
        score += points;
        options[index].classList.add('correct');
        showFeedback(true, "‚úÖ ¬°Correcto! " + question.explanation, points);
      } else {
        options[index].classList.add('incorrect');
        options[question.shuffledCorrect].classList.add('correct');
        showFeedback(false, "‚ùå Incorrecto. " + question.explanation, 0);
      }
      
      userAnswers.push({
        question: question.question,
        selectedIndex: index,
        correctIndex: question.shuffledCorrect,
        selectedAnswer: selectedAnswerText,
        correctAnswer: correctAnswerText,
        isCorrect: isCorrect,
        points: points,
        time: timeTaken
      });
      
      totalTime += timeTaken;
      document.getElementById('scoreDisplay').textContent = score + ' pts';
      document.getElementById('nextBtn').style.display = 'block';
      
      if (isCorrect) {
        createConfetti();
      }
    }
    
    function showFeedback(isCorrect, message, points) {
      const feedback = document.getElementById('feedback');
      feedback.className = 'feedback ' + (isCorrect ? 'correct' : 'incorrect');
      feedback.innerHTML = message + (points > 0 ? ` <strong>+${points} pts</strong>` : '');
      feedback.style.display = 'block';
    }
    
    function nextQuestion() {
      currentQuestionIndex++;
      loadQuestion();
    }
    
    function startTimer() {
      const timerDisplay = document.getElementById('timer');
      timerDisplay.textContent = timeLeft;
      timerDisplay.classList.remove('warning');
      
      timer = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = timeLeft;
        
        if (timeLeft <= 10) {
          timerDisplay.classList.add('warning');
        }
        
        if (timeLeft <= 0) {
          clearInterval(timer);
          if (selectedAnswer === -1) {
            timeoutQuestion();
          }
        }
      }, 1000);
    }
    
    function timeoutQuestion() {
      const question = questionPool[currentQuestionIndex];
      const options = document.querySelectorAll('.option');
      
      options.forEach(opt => opt.onclick = null);
      options[question.shuffledCorrect].classList.add('correct');
      
      const correctAnswerText = question.shuffledOptions[question.shuffledCorrect].text;
      
      userAnswers.push({
        question: question.question,
        selectedIndex: -1,
        correctIndex: question.shuffledCorrect,
        selectedAnswer: 'Sin respuesta (tiempo agotado)',
        correctAnswer: correctAnswerText,
        isCorrect: false,
        points: 0,
        time: 30
      });
      
      totalTime += 30;
      showFeedback(false, "‚è∞ ¬°Se acab√≥ el tiempo! " + question.explanation, 0);
      document.getElementById('nextBtn').style.display = 'block';
    }
    
    function showResults() {
      document.getElementById('questionScreen').classList.remove('active');
      document.getElementById('resultsScreen').classList.add('active');
      
      const correctCount = userAnswers.filter(a => a.isCorrect).length;
      const accuracy = Math.round((correctCount / questionPool.length) * 100);
      const avgTime = Math.round(totalTime / questionPool.length);
      
      document.getElementById('finalScore').textContent = score + ' pts';
      document.getElementById('correctCount').textContent = correctCount + '/10';
      document.getElementById('accuracyPercent').textContent = accuracy + '%';
      document.getElementById('timeAverage').textContent = avgTime + 's';
      
      let message, trophy;
      if (accuracy === 100) {
        trophy = 'üèÜ';
        message = '¬°PERFECTO! Eres un maestro del √°lgebra lineal üéì‚ú®';
      } else if (accuracy >= 75) {
        trophy = '‚≠ê';
        message = '¬°EXCELENTE! Dominas muy bien las matrices üöÄüìä';
      } else if (accuracy >= 50) {
        trophy = 'üéØ';
        message = '¬°BUEN TRABAJO! Un poco m√°s de pr√°ctica üí™üìê';
      } else {
        trophy = 'üìö';
        message = '¬°NO TE RINDAS! Repasa los conceptos üåüüî¢';
      }
      
      document.getElementById('trophyEmoji').textContent = trophy;
      document.getElementById('resultsMessage').textContent = message;
      
      generatePersonalFeedback(correctCount, accuracy, avgTime);
      
      if (accuracy >= 75) {
        createMassiveConfetti();
      }
    }
    
    function generatePersonalFeedback(correct, accuracy, avgTime) {
      const container = document.getElementById('personalFeedback');
      let feedback = '<h4 style="color: var(--primary); margin-bottom: 15px;">üìä An√°lisis Detallado</h4>';
      
      if (avgTime < 15) {
        feedback += '<p>‚ö° <strong>Velocidad impresionante</strong> - Respondes r√°pidamente y con confianza</p>';
      } else if (avgTime < 25) {
        feedback += '<p>‚è±Ô∏è <strong>Ritmo adecuado</strong> - Te tomas el tiempo necesario para pensar</p>';
      } else {
        feedback += '<p>üê¢ <strong>T√≥mate tu tiempo</strong> - No hay prisa, la comprensi√≥n es lo importante</p>';
      }
      
      if (accuracy === 100) {
        feedback += '<p>üéØ <strong>Precisi√≥n perfecta!</strong> - Dominas completamente el tema</p>';
      } else if (accuracy >= 75) {
        feedback += '<p>‚úÖ <strong>Alta precisi√≥n</strong> - Excelente comprensi√≥n de los conceptos</p>';
      } else if (accuracy >= 50) {
        feedback += '<p>üìà <strong>En progreso</strong> - Vas por buen camino, sigue practicando</p>';
      } else {
        feedback += '<p>üí° <strong>√Årea de mejora</strong> - Repasa los conceptos fundamentales</p>';
      }
      
      const weekTips = {
        1: 'Practica identificar tipos de matrices y sus propiedades üìê',
        2: 'Domina la multiplicaci√≥n matricial y sus propiedades ‚ûï‚úñÔ∏è',
        3: 'Practica el m√©todo de Gauss-Jordan paso a paso üîÑ',
        4: 'Memoriza las propiedades de los determinantes üé≤'
      };
      
      feedback += '<p>üí≠ <strong>Tip para Semana ' + currentWeek + ':</strong> ' + weekTips[currentWeek] + '</p>';
      container.innerHTML = feedback;
    }
    
    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }
    
    function createConfetti() {
      const container = document.getElementById('confetti');
      const colors = ['#6496fa', '#00d4aa', '#ffd60a', '#06d6a0', '#ef476f'];
      
      for (let i = 0; i < 30; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.left = Math.random() * 100 + '%';
        piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        container.appendChild(piece);
        setTimeout(() => piece.remove(), 3000);
      }
    }
    
    function createMassiveConfetti() {
      const container = document.getElementById('confetti');
      const colors = ['#6496fa', '#00d4aa', '#ffd60a', '#06d6a0', '#ef476f'];
      
      for (let i = 0; i < 100; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.left = Math.random() * 100 + '%';
        piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        piece.style.width = (5 + Math.random() * 10) + 'px';
        piece.style.height = (5 + Math.random() * 10) + 'px';
        container.appendChild(piece);
        setTimeout(() => piece.remove(), 5000);
      }
    }
    
    function toggleTheme() {
      const current = document.documentElement.getAttribute('data-theme');
      const newTheme = current === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme-algebra-quiz', newTheme);
    }
    
    function restartQuiz() {
      document.getElementById('resultsScreen').classList.remove('active');
      document.getElementById('startScreen').classList.remove('hidden');
      currentQuestionIndex = 0;
      score = 0;
      userAnswers = [];
      totalTime = 0;
    }
    
    function reviewAnswers() {
      let review = 'üìä REVISI√ìN - Semana ' + currentWeek + '\n\n';
      userAnswers.forEach((answer, index) => {
        const question = questionPool[index];
        const status = answer.isCorrect ? '‚úÖ' : '‚ùå';
        review += status + ' P' + (index + 1) + ': ' + (answer.points > 0 ? '+' + answer.points + ' pts' : '0 pts') + '\n';
        review += '‚ùì ' + question.question + '\n';
        if (answer.selectedIndex === -1) {
          review += '‚è∞ Tiempo agotado\n';
        } else {
          review += 'üìù Tu respuesta: ' + answer.selectedAnswer + '\n';
        }
        if (!answer.isCorrect) {
          review += '‚úì Correcta: ' + answer.correctAnswer + '\n';
        }
        review += '\n';
      });
      alert(review);
    }
    
    function shareResults() {
      const correctCount = userAnswers.filter(a => a.isCorrect).length;
      const accuracy = Math.round((correctCount / questionPool.length) * 100);
      const text = 'üéØ ¬°Quiz √Ålgebra Lineal!\nüíé ' + score + ' puntos\n‚úÖ ' + correctCount + '/10\nüéØ ' + accuracy + '%\n\n#√ÅlgebraLineal #SABES';
      
      if (navigator.share) {
        navigator.share({ title: 'Quiz √Ålgebra Lineal', text: text });
      } else {
        navigator.clipboard.writeText(text).then(() => alert('‚úÖ ¬°Resultados copiados al portapapeles!'));
      }
    }
    
    function openModal() {
      document.getElementById('privacyModal').classList.add('show');
    }
    
    function closeModal() {
      document.getElementById('privacyModal').classList.remove('show');
    }
    
    function showCredits() {
      document.getElementById('startScreen').classList.add('hidden');
      document.getElementById('creditsScreen').classList.add('active');
      window.scrollTo(0, 0);
    }
    
    function closeCredits() {
      document.getElementById('creditsScreen').classList.remove('active');
      document.getElementById('startScreen').classList.remove('hidden');
      window.scrollTo(0, 0);
    }
    
    // Atajos de teclado
    document.addEventListener('keydown', function(event) {
      const questionScreen = document.getElementById('questionScreen');
      const modal = document.getElementById('privacyModal');
      
      if (modal.classList.contains('show') && event.key === 'Escape') {
        closeModal();
      }
      
      if (questionScreen.classList.contains('active')) {
        if (event.key >= '1' && event.key <= '4') {
          const index = parseInt(event.key) - 1;
          if (selectedAnswer === -1) {
            selectOption(index);
          }
        }
        if (event.key === 'Enter') {
          const nextBtn = document.getElementById('nextBtn');
          if (nextBtn.style.display !== 'none') {
            nextQuestion();
          }
        }
      }
    });
    
    // Cargar tema guardado
    document.addEventListener('DOMContentLoaded', function() {
      const savedTheme = localStorage.getItem('theme-algebra-quiz') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      console.log('üéØ Quiz cargado - ‚ôø WCAG 2.2 AA compatible');
    });
  </script>
</body>
</html>
